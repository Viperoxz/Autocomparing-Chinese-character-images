12.4s 1 Available RAM before loading: 30.09 GB
12.4s 2 Loading /kaggle/input/create-trainset/train_pairs.h5 into RAM...
39.5s 3 img1 shape: (146600, 64, 64), min/max: 0.0/1.0
40.4s 4 img2 shape: (146600, 64, 64), min/max: 0.0/1.0
40.4s 5 Loaded in 27.97s
40.4s 6 Loading /kaggle/input/create-trainset/valid_pairs.h5 into RAM...
45.4s 7 img1 shape: (29320, 64, 64), min/max: 0.0/1.0
45.4s 8 img2 shape: (29320, 64, 64), min/max: 0.0/1.0
45.4s 9 Loaded in 5.16s
45.4s 10 Loading /kaggle/input/create-testset/test_pairs.h5 into RAM...
59.7s 11 img1 shape: (73300, 64, 64), min/max: 0.0/1.0
59.9s 12 img2 shape: (73300, 64, 64), min/max: 0.0/1.0
59.9s 13 Loaded in 14.54s
59.9s 14 Train dataset: 146600 pairs, Ratio of similar pairs: 0.50
59.9s 15 Validation dataset: 29320 pairs, Ratio of similar pairs: 0.50
59.9s 16 Test dataset: 73300 pairs, Ratio of similar pairs: 0.50
59.9s 17 Available RAM after loading: 22.38 GB
60.1s 18 
60.1s 19 Trying hyperparameters: lr=0.0005, margin=1.0, threshold=0.3
191.6s 20 Epoch 1/20 - loss: 3.8024 - val_loss: 0.1338 - val_acc: 64.68%
191.6s 21 val_loss improved from inf to 0.1338, saving model...
191.6s 22 Current LR: 0.000500
324.0s 23 Epoch 2/20 - loss: 0.1066 - val_loss: 0.0895 - val_acc: 73.30%
324.0s 24 val_loss improved from 0.1338 to 0.0895, saving model...
324.0s 25 Current LR: 0.000500
456.6s 26 Epoch 3/20 - loss: 0.0866 - val_loss: 0.0777 - val_acc: 74.64%
456.6s 27 val_loss improved from 0.0895 to 0.0777, saving model...
456.6s 28 Current LR: 0.000500
588.8s 29 Epoch 4/20 - loss: 0.0808 - val_loss: 0.0716 - val_acc: 76.08%
588.8s 30 val_loss improved from 0.0777 to 0.0716, saving model...
588.8s 31 Current LR: 0.000500
721.1s 32 Epoch 5/20 - loss: 0.0760 - val_loss: 0.0693 - val_acc: 76.82%
721.1s 33 val_loss improved from 0.0716 to 0.0693, saving model...
721.1s 34 Current LR: 0.000500
853.1s 35 Epoch 6/20 - loss: 0.0753 - val_loss: 0.0664 - val_acc: 77.08%
853.1s 36 val_loss improved from 0.0693 to 0.0664, saving model...
853.1s 37 Current LR: 0.000500
984.9s 38 Epoch 7/20 - loss: 0.0752 - val_loss: 0.0685 - val_acc: 76.06%
984.9s 39 Patience Counter: 1/10
984.9s 40 Current LR: 0.000500
1116.8s 41 Epoch 8/20 - loss: 0.0746 - val_loss: 0.0716 - val_acc: 76.88%
1116.8s 42 Patience Counter: 2/10
1116.8s 43 Current LR: 0.000500
1248.8s 44 Epoch 9/20 - loss: 0.0741 - val_loss: 0.0676 - val_acc: 77.07%
1248.8s 45 Patience Counter: 3/10
1248.8s 46 Current LR: 0.000500
1380.5s 47 Epoch 10/20 - loss: 0.0739 - val_loss: 0.0676 - val_acc: 76.89%
1380.5s 48 Patience Counter: 4/10
1380.5s 49 Current LR: 0.000250
1512.2s 50 Epoch 11/20 - loss: 0.0701 - val_loss: 0.0626 - val_acc: 77.50%
1512.2s 51 val_loss improved from 0.0664 to 0.0626, saving model...
1512.2s 52 Current LR: 0.000250
1643.5s 53 Epoch 12/20 - loss: 0.0696 - val_loss: 0.0652 - val_acc: 77.64%
1643.5s 54 Patience Counter: 1/10
1643.5s 55 Current LR: 0.000250
1774.2s 56 Epoch 13/20 - loss: 0.0691 - val_loss: 0.0628 - val_acc: 77.47%
1774.2s 57 Patience Counter: 2/10
1774.2s 58 Current LR: 0.000250
1904.4s 59 Epoch 14/20 - loss: 0.0689 - val_loss: 0.0658 - val_acc: 77.91%
1904.4s 60 Patience Counter: 3/10
1904.4s 61 Current LR: 0.000250
2035.0s 62 Epoch 15/20 - loss: 0.0685 - val_loss: 0.0614 - val_acc: 77.95%
2035.0s 63 val_loss improved from 0.0626 to 0.0614, saving model...
2035.0s 64 Current LR: 0.000250
2164.1s 65 Epoch 16/20 - loss: 0.0688 - val_loss: 0.0614 - val_acc: 77.66%
2164.1s 66 Patience Counter: 1/10
2164.1s 67 Current LR: 0.000250
2293.3s 68 Epoch 17/20 - loss: 0.0684 - val_loss: 0.0626 - val_acc: 77.41%
2293.3s 69 Patience Counter: 2/10
2293.3s 70 Current LR: 0.000250
2422.0s 71 Epoch 18/20 - loss: 0.0681 - val_loss: 0.0624 - val_acc: 78.05%
2422.0s 72 Patience Counter: 3/10
2422.0s 73 Current LR: 0.000250
2550.2s 74 Epoch 19/20 - loss: 0.0679 - val_loss: 0.0604 - val_acc: 78.34%
2550.2s 75 val_loss improved from 0.0614 to 0.0604, saving model...
2550.2s 76 Current LR: 0.000250
2677.7s 77 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:07<40:23, 127.56s/epoch]Training Progress:  10%|█         | 2/20 [04:20<39:07, 130.43s/epoch]Training Progress:  15%|█▌        | 3/20 [06:32<37:13, 131.40s/epoch]Training Progress:  20%|██        | 4/20 [08:44<35:07, 131.74s/epoch]Training Progress:  25%|██▌       | 5/20 [10:57<32:59, 131.93s/epoch]Training Progress:  30%|███       | 6/20 [13:09<30:47, 131.95s/epoch]Training Progress:  35%|███▌      | 7/20 [15:20<28:34, 131.91s/epoch]Training Progress:  40%|████      | 8/20 [17:32<26:22, 131.91s/epoch]Training Progress:  45%|████▌     | 9/20 [19:44<24:11, 131.93s/epoch]Training Progress:  50%|█████     | 10/20 [21:56<21:58, 131.84s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:08<19:46, 131.81s/epoch]Training Progress:  60%|██████    | 12/20 [26:19<17:33, 131.65s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:30<15:19, 131.36s/epoch]Training Progress:  70%|███████   | 14/20 [30:40<13:06, 131.00s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:50<10:54, 130.89s/epoch]Training Progress:  80%|████████  | 16/20 [35:00<08:41, 130.37s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:09<06:29, 130.00s/epoch]Training Progress:  90%|█████████ | 18/20 [39:17<04:19, 129.61s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:26<02:09, 129.18s/epoch]Training Progress: 100%|██████████| 20/20 [43:33<00:00, 128.68s/epoch]Training Progress: 100%|██████████| 20/20 [43:33<00:00, 130.68s/epoch]
2677.7s 78 Epoch 20/20 - loss: 0.0677 - val_loss: 0.0626 - val_acc: 78.38%
2677.7s 79 Patience Counter: 1/10
2677.7s 80 Current LR: 0.000250
2677.7s 81 Loaded best model with val_loss: 0.0604
2677.7s 82 Best val_acc for this run: 78.38%
2677.7s 83 
2677.7s 84 Trying hyperparameters: lr=0.0005, margin=1.0, threshold=0.4
2810.1s 85 Epoch 1/20 - loss: 3.9085 - val_loss: 0.1335 - val_acc: 65.98%
2810.1s 86 val_loss improved from inf to 0.1335, saving model...
2810.1s 87 Current LR: 0.000500
2942.4s 88 Epoch 2/20 - loss: 0.1045 - val_loss: 0.0845 - val_acc: 77.05%
2942.4s 89 val_loss improved from 0.1335 to 0.0845, saving model...
2942.4s 90 Current LR: 0.000500
3074.9s 91 Epoch 3/20 - loss: 0.0861 - val_loss: 0.0759 - val_acc: 79.19%
3074.9s 92 val_loss improved from 0.0845 to 0.0759, saving model...
3074.9s 93 Current LR: 0.000500
3207.2s 94 Epoch 4/20 - loss: 0.0805 - val_loss: 0.0737 - val_acc: 80.62%
3207.2s 95 val_loss improved from 0.0759 to 0.0737, saving model...
3207.2s 96 Current LR: 0.000500
3339.4s 97 Epoch 5/20 - loss: 0.0766 - val_loss: 0.0695 - val_acc: 81.46%
3339.4s 98 val_loss improved from 0.0737 to 0.0695, saving model...
3339.4s 99 Current LR: 0.000500
3471.2s 100 Epoch 6/20 - loss: 0.0752 - val_loss: 0.0713 - val_acc: 79.92%
3471.2s 101 Patience Counter: 1/10
3471.2s 102 Current LR: 0.000500
3603.1s 103 Epoch 7/20 - loss: 0.0748 - val_loss: 0.0659 - val_acc: 80.86%
3603.1s 104 val_loss improved from 0.0695 to 0.0659, saving model...
3603.1s 105 Current LR: 0.000500
3735.1s 106 Epoch 8/20 - loss: 0.0744 - val_loss: 0.0662 - val_acc: 80.88%
3735.1s 107 Patience Counter: 1/10
3735.1s 108 Current LR: 0.000500
3867.4s 109 Epoch 9/20 - loss: 0.0744 - val_loss: 0.0688 - val_acc: 80.39%
3867.4s 110 Patience Counter: 2/10
3867.4s 111 Current LR: 0.000500
3999.3s 112 Epoch 10/20 - loss: 0.0741 - val_loss: 0.0713 - val_acc: 79.91%
3999.3s 113 Patience Counter: 3/10
3999.3s 114 Current LR: 0.000500
4131.0s 115 Epoch 11/20 - loss: 0.0736 - val_loss: 0.0700 - val_acc: 80.45%
4131.0s 116 Patience Counter: 4/10
4131.0s 117 Current LR: 0.000250
4262.7s 118 Epoch 12/20 - loss: 0.0702 - val_loss: 0.0673 - val_acc: 82.06%
4262.7s 119 Patience Counter: 5/10
4262.7s 120 Current LR: 0.000250
4393.7s 121 Epoch 13/20 - loss: 0.0696 - val_loss: 0.0657 - val_acc: 82.42%
4393.7s 122 val_loss improved from 0.0659 to 0.0657, saving model...
4393.7s 123 Current LR: 0.000250
4524.4s 124 Epoch 14/20 - loss: 0.0694 - val_loss: 0.0647 - val_acc: 82.31%
4524.4s 125 val_loss improved from 0.0657 to 0.0647, saving model...
4524.4s 126 Current LR: 0.000250
4654.4s 127 Epoch 15/20 - loss: 0.0689 - val_loss: 0.0615 - val_acc: 83.53%
4654.4s 128 val_loss improved from 0.0647 to 0.0615, saving model...
4654.4s 129 Current LR: 0.000250
4783.8s 130 Epoch 16/20 - loss: 0.0685 - val_loss: 0.0639 - val_acc: 81.78%
4783.8s 131 Patience Counter: 1/10
4783.8s 132 Current LR: 0.000250
4913.3s 133 Epoch 17/20 - loss: 0.0684 - val_loss: 0.0617 - val_acc: 82.91%
4913.3s 134 Patience Counter: 2/10
4913.3s 135 Current LR: 0.000250
5042.3s 136 Epoch 18/20 - loss: 0.0682 - val_loss: 0.0617 - val_acc: 82.83%
5042.3s 137 Patience Counter: 3/10
5042.3s 138 Current LR: 0.000250
5170.8s 139 Epoch 19/20 - loss: 0.0679 - val_loss: 0.0623 - val_acc: 82.91%
5170.8s 140 Patience Counter: 4/10
5170.8s 141 Current LR: 0.000125
5298.8s 142 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:55, 132.38s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:42, 132.35s/epoch]Training Progress:  15%|█▌        | 3/20 [06:37<37:30, 132.39s/epoch]Training Progress:  20%|██        | 4/20 [08:49<35:17, 132.36s/epoch]Training Progress:  25%|██▌       | 5/20 [11:01<33:04, 132.31s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:49, 132.13s/epoch]Training Progress:  35%|███▌      | 7/20 [15:25<28:36, 132.05s/epoch]Training Progress:  40%|████      | 8/20 [17:37<26:24, 132.03s/epoch]Training Progress:  45%|████▌     | 9/20 [19:49<24:13, 132.11s/epoch]Training Progress:  50%|█████     | 10/20 [22:01<22:00, 132.06s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:13<19:47, 131.94s/epoch]Training Progress:  60%|██████    | 12/20 [26:24<17:34, 131.86s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:35<15:21, 131.62s/epoch]Training Progress:  70%|███████   | 14/20 [30:46<13:07, 131.33s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:56<10:54, 130.93s/epoch]Training Progress:  80%|████████  | 16/20 [35:06<08:41, 130.48s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:15<06:30, 130.18s/epoch]Training Progress:  90%|█████████ | 18/20 [39:24<04:19, 129.82s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:32<02:09, 129.41s/epoch]Training Progress: 100%|██████████| 20/20 [43:40<00:00, 128.98s/epoch]Training Progress: 100%|██████████| 20/20 [43:40<00:00, 131.05s/epoch]
5298.8s 143 Epoch 20/20 - loss: 0.0657 - val_loss: 0.0607 - val_acc: 83.33%
5298.8s 144 val_loss improved from 0.0615 to 0.0607, saving model...
5298.8s 145 Current LR: 0.000125
5298.8s 146 Loaded best model with val_loss: 0.0607
5298.8s 147 Best val_acc for this run: 83.53%
5298.8s 148 
5298.8s 149 Trying hyperparameters: lr=0.0005, margin=1.0, threshold=0.45
5431.0s 150 Epoch 1/20 - loss: 3.8831 - val_loss: 0.1530 - val_acc: 52.30%
5431.0s 151 val_loss improved from inf to 0.1530, saving model...
5431.0s 152 Current LR: 0.000500
5563.2s 153 Epoch 2/20 - loss: 0.1046 - val_loss: 0.0851 - val_acc: 76.39%
5563.2s 154 val_loss improved from 0.1530 to 0.0851, saving model...
5563.2s 155 Current LR: 0.000500
5695.6s 156 Epoch 3/20 - loss: 0.0864 - val_loss: 0.0763 - val_acc: 79.04%
5695.6s 157 val_loss improved from 0.0851 to 0.0763, saving model...
5695.6s 158 Current LR: 0.000500
5827.8s 159 Epoch 4/20 - loss: 0.0789 - val_loss: 0.0672 - val_acc: 80.67%
5827.8s 160 val_loss improved from 0.0763 to 0.0672, saving model...
5827.8s 161 Current LR: 0.000500
5959.8s 162 Epoch 5/20 - loss: 0.0753 - val_loss: 0.0701 - val_acc: 81.58%
5959.8s 163 Patience Counter: 1/10
5959.8s 164 Current LR: 0.000500
6091.6s 165 Epoch 6/20 - loss: 0.0753 - val_loss: 0.0752 - val_acc: 80.59%
6091.6s 166 Patience Counter: 2/10
6091.6s 167 Current LR: 0.000500
6223.4s 168 Epoch 7/20 - loss: 0.0752 - val_loss: 0.0712 - val_acc: 80.30%
6223.4s 169 Patience Counter: 3/10
6223.4s 170 Current LR: 0.000500
6355.4s 171 Epoch 8/20 - loss: 0.0751 - val_loss: 0.0709 - val_acc: 80.90%
6355.4s 172 Patience Counter: 4/10
6355.4s 173 Current LR: 0.000250
6487.6s 174 Epoch 9/20 - loss: 0.0711 - val_loss: 0.0672 - val_acc: 82.27%
6487.6s 175 Patience Counter: 5/10
6487.6s 176 Current LR: 0.000250
6619.8s 177 Epoch 10/20 - loss: 0.0708 - val_loss: 0.0671 - val_acc: 81.83%
6619.8s 178 val_loss improved from 0.0672 to 0.0671, saving model...
6619.8s 179 Current LR: 0.000250
6751.7s 180 Epoch 11/20 - loss: 0.0702 - val_loss: 0.0638 - val_acc: 83.66%
6751.7s 181 val_loss improved from 0.0671 to 0.0638, saving model...
6751.7s 182 Current LR: 0.000250
6883.3s 183 Epoch 12/20 - loss: 0.0699 - val_loss: 0.0635 - val_acc: 83.66%
6883.3s 184 val_loss improved from 0.0638 to 0.0635, saving model...
6883.3s 185 Current LR: 0.000250
7014.3s 186 Epoch 13/20 - loss: 0.0692 - val_loss: 0.0661 - val_acc: 82.39%
7014.3s 187 Patience Counter: 1/10
7014.3s 188 Current LR: 0.000250
7145.0s 189 Epoch 14/20 - loss: 0.0691 - val_loss: 0.0637 - val_acc: 83.18%
7145.0s 190 Patience Counter: 2/10
7145.0s 191 Current LR: 0.000250
7275.3s 192 Epoch 15/20 - loss: 0.0688 - val_loss: 0.0621 - val_acc: 83.97%
7275.3s 193 val_loss improved from 0.0635 to 0.0621, saving model...
7275.3s 194 Current LR: 0.000250
7405.7s 195 Epoch 16/20 - loss: 0.0685 - val_loss: 0.0624 - val_acc: 84.01%
7405.7s 196 Patience Counter: 1/10
7405.7s 197 Current LR: 0.000250
7535.6s 198 Epoch 17/20 - loss: 0.0684 - val_loss: 0.0642 - val_acc: 83.35%
7535.6s 199 Patience Counter: 2/10
7535.6s 200 Current LR: 0.000250
7665.1s 201 Epoch 18/20 - loss: 0.0680 - val_loss: 0.0626 - val_acc: 84.03%
7665.1s 202 Patience Counter: 3/10
7665.1s 203 Current LR: 0.000250
7793.7s 204 Epoch 19/20 - loss: 0.0678 - val_loss: 0.0640 - val_acc: 83.68%
7793.7s 205 Patience Counter: 4/10
7793.7s 206 Current LR: 0.000125
7921.6s 207 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:52, 132.25s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:39, 132.21s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:28, 132.29s/epoch]Training Progress:  20%|██        | 4/20 [08:49<35:16, 132.25s/epoch]Training Progress:  25%|██▌       | 5/20 [11:01<33:02, 132.16s/epoch]Training Progress:  30%|███       | 6/20 [13:12<30:48, 132.01s/epoch]Training Progress:  35%|███▌      | 7/20 [15:24<28:35, 131.95s/epoch]Training Progress:  40%|████      | 8/20 [17:36<26:23, 131.98s/epoch]Training Progress:  45%|████▌     | 9/20 [19:48<24:12, 132.03s/epoch]Training Progress:  50%|█████     | 10/20 [22:00<22:00, 132.09s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:12<19:48, 132.04s/epoch]Training Progress:  60%|██████    | 12/20 [26:24<17:35, 131.93s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:35<15:21, 131.61s/epoch]Training Progress:  70%|███████   | 14/20 [30:46<13:08, 131.34s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:56<10:55, 131.05s/epoch]Training Progress:  80%|████████  | 16/20 [35:06<08:43, 130.82s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:16<06:31, 130.56s/epoch]Training Progress:  90%|█████████ | 18/20 [39:26<04:20, 130.23s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:34<02:09, 129.75s/epoch]Training Progress: 100%|██████████| 20/20 [43:42<00:00, 129.20s/epoch]Training Progress: 100%|██████████| 20/20 [43:42<00:00, 131.14s/epoch]
7921.6s 208 Epoch 20/20 - loss: 0.0659 - val_loss: 0.0594 - val_acc: 84.34%
7921.6s 209 val_loss improved from 0.0621 to 0.0594, saving model...
7921.6s 210 Current LR: 0.000125
7921.6s 211 Loaded best model with val_loss: 0.0594
7921.6s 212 Best val_acc for this run: 84.34%
7921.6s 213 
7921.6s 214 Trying hyperparameters: lr=0.0005, margin=1.0, threshold=0.5
8054.0s 215 Epoch 1/20 - loss: 3.7985 - val_loss: 0.1479 - val_acc: 59.36%
8054.0s 216 val_loss improved from inf to 0.1479, saving model...
8054.0s 217 Current LR: 0.000500
8186.2s 218 Epoch 2/20 - loss: 0.1056 - val_loss: 0.0841 - val_acc: 76.29%
8186.2s 219 val_loss improved from 0.1479 to 0.0841, saving model...
8186.2s 220 Current LR: 0.000500
8318.6s 221 Epoch 3/20 - loss: 0.0869 - val_loss: 0.0779 - val_acc: 78.54%
8318.6s 222 val_loss improved from 0.0841 to 0.0779, saving model...
8318.6s 223 Current LR: 0.000500
8450.9s 224 Epoch 4/20 - loss: 0.0810 - val_loss: 0.0705 - val_acc: 80.92%
8450.9s 225 val_loss improved from 0.0779 to 0.0705, saving model...
8450.9s 226 Current LR: 0.000500
8583.0s 227 Epoch 5/20 - loss: 0.0770 - val_loss: 0.0718 - val_acc: 80.51%
8583.0s 228 Patience Counter: 1/10
8583.0s 229 Current LR: 0.000500
8715.1s 230 Epoch 6/20 - loss: 0.0754 - val_loss: 0.0667 - val_acc: 82.00%
8715.1s 231 val_loss improved from 0.0705 to 0.0667, saving model...
8715.1s 232 Current LR: 0.000500
8846.9s 233 Epoch 7/20 - loss: 0.0752 - val_loss: 0.0687 - val_acc: 81.78%
8846.9s 234 Patience Counter: 1/10
8846.9s 235 Current LR: 0.000500
8979.0s 236 Epoch 8/20 - loss: 0.0752 - val_loss: 0.0675 - val_acc: 82.14%
8979.0s 237 Patience Counter: 2/10
8979.0s 238 Current LR: 0.000500
9111.2s 239 Epoch 9/20 - loss: 0.0746 - val_loss: 0.0706 - val_acc: 81.03%
9111.2s 240 Patience Counter: 3/10
9111.2s 241 Current LR: 0.000500
9243.2s 242 Epoch 10/20 - loss: 0.0740 - val_loss: 0.0710 - val_acc: 80.94%
9243.2s 243 Patience Counter: 4/10
9243.2s 244 Current LR: 0.000250
9375.1s 245 Epoch 11/20 - loss: 0.0706 - val_loss: 0.0681 - val_acc: 81.76%
9375.1s 246 Patience Counter: 5/10
9375.1s 247 Current LR: 0.000250
9506.5s 248 Epoch 12/20 - loss: 0.0703 - val_loss: 0.0646 - val_acc: 83.18%
9506.5s 249 val_loss improved from 0.0667 to 0.0646, saving model...
9506.5s 250 Current LR: 0.000250
9637.5s 251 Epoch 13/20 - loss: 0.0697 - val_loss: 0.0644 - val_acc: 82.95%
9637.5s 252 val_loss improved from 0.0646 to 0.0644, saving model...
9637.5s 253 Current LR: 0.000250
9768.4s 254 Epoch 14/20 - loss: 0.0695 - val_loss: 0.0647 - val_acc: 82.85%
9768.4s 255 Patience Counter: 1/10
9768.4s 256 Current LR: 0.000250
9898.6s 257 Epoch 15/20 - loss: 0.0693 - val_loss: 0.0633 - val_acc: 83.37%
9898.6s 258 val_loss improved from 0.0644 to 0.0633, saving model...
9898.6s 259 Current LR: 0.000250
10028.6s 260 Epoch 16/20 - loss: 0.0692 - val_loss: 0.0648 - val_acc: 83.20%
10028.6s 261 Patience Counter: 1/10
10028.6s 262 Current LR: 0.000250
10158.1s 263 Epoch 17/20 - loss: 0.0688 - val_loss: 0.0624 - val_acc: 83.65%
10158.1s 264 val_loss improved from 0.0633 to 0.0624, saving model...
10158.1s 265 Current LR: 0.000250
10287.3s 266 Epoch 18/20 - loss: 0.0689 - val_loss: 0.0629 - val_acc: 83.44%
10287.3s 267 Patience Counter: 1/10
10287.3s 268 Current LR: 0.000250
10415.8s 269 Epoch 19/20 - loss: 0.0686 - val_loss: 0.0639 - val_acc: 82.96%
10415.8s 270 Patience Counter: 2/10
10415.8s 271 Current LR: 0.000250
10543.7s 272 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:55, 132.39s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:39, 132.22s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:29, 132.31s/epoch]Training Progress:  20%|██        | 4/20 [08:49<35:16, 132.31s/epoch]Training Progress:  25%|██▌       | 5/20 [11:01<33:03, 132.23s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:50, 132.18s/epoch]Training Progress:  35%|███▌      | 7/20 [15:25<28:36, 132.07s/epoch]Training Progress:  40%|████      | 8/20 [17:37<26:24, 132.04s/epoch]Training Progress:  45%|████▌     | 9/20 [19:49<24:13, 132.11s/epoch]Training Progress:  50%|█████     | 10/20 [22:01<22:00, 132.07s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:13<19:48, 132.04s/epoch]Training Progress:  60%|██████    | 12/20 [26:24<17:34, 131.84s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:35<15:21, 131.58s/epoch]Training Progress:  70%|███████   | 14/20 [30:46<13:08, 131.37s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:56<10:55, 131.02s/epoch]Training Progress:  80%|████████  | 16/20 [35:06<08:42, 130.70s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:16<06:31, 130.38s/epoch]Training Progress:  90%|█████████ | 18/20 [39:25<04:20, 130.00s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:34<02:09, 129.55s/epoch]Training Progress: 100%|██████████| 20/20 [43:41<00:00, 129.05s/epoch]Training Progress: 100%|██████████| 20/20 [43:41<00:00, 131.10s/epoch]
10543.7s 273 Epoch 20/20 - loss: 0.0686 - val_loss: 0.0634 - val_acc: 83.18%
10543.7s 274 Patience Counter: 3/10
10543.7s 275 Current LR: 0.000250
10543.7s 276 Loaded best model with val_loss: 0.0624
10543.7s 277 Best val_acc for this run: 83.65%
10543.7s 278 
10543.7s 279 Trying hyperparameters: lr=0.0005, margin=1.5, threshold=0.3
10675.8s 280 Epoch 1/20 - loss: 4.0452 - val_loss: 0.3154 - val_acc: 65.10%
10675.8s 281 val_loss improved from inf to 0.3154, saving model...
10675.8s 282 Current LR: 0.000500
10808.3s 283 Epoch 2/20 - loss: 0.2223 - val_loss: 0.1844 - val_acc: 68.42%
10808.3s 284 val_loss improved from 0.3154 to 0.1844, saving model...
10808.3s 285 Current LR: 0.000500
10940.6s 286 Epoch 3/20 - loss: 0.1875 - val_loss: 0.1657 - val_acc: 64.99%
10940.6s 287 val_loss improved from 0.1844 to 0.1657, saving model...
10940.6s 288 Current LR: 0.000500
11073.5s 289 Epoch 4/20 - loss: 0.1739 - val_loss: 0.1523 - val_acc: 66.71%
11073.5s 290 val_loss improved from 0.1657 to 0.1523, saving model...
11073.5s 291 Current LR: 0.000500
11205.7s 292 Epoch 5/20 - loss: 0.1676 - val_loss: 0.1458 - val_acc: 66.94%
11205.7s 293 val_loss improved from 0.1523 to 0.1458, saving model...
11205.7s 294 Current LR: 0.000500
11337.7s 295 Epoch 6/20 - loss: 0.1654 - val_loss: 0.1470 - val_acc: 66.78%
11337.7s 296 Patience Counter: 1/10
11337.7s 297 Current LR: 0.000500
11469.7s 298 Epoch 7/20 - loss: 0.1648 - val_loss: 0.1521 - val_acc: 66.37%
11469.7s 299 Patience Counter: 2/10
11469.7s 300 Current LR: 0.000500
11601.7s 301 Epoch 8/20 - loss: 0.1639 - val_loss: 0.1503 - val_acc: 67.11%
11601.7s 302 Patience Counter: 3/10
11601.7s 303 Current LR: 0.000500
11733.9s 304 Epoch 9/20 - loss: 0.1614 - val_loss: 0.1485 - val_acc: 67.70%
11733.9s 305 Patience Counter: 4/10
11733.9s 306 Current LR: 0.000250
11865.6s 307 Epoch 10/20 - loss: 0.1530 - val_loss: 0.1361 - val_acc: 69.40%
11865.6s 308 val_loss improved from 0.1458 to 0.1361, saving model...
11865.6s 309 Current LR: 0.000250
11997.5s 310 Epoch 11/20 - loss: 0.1504 - val_loss: 0.1368 - val_acc: 68.95%
11997.5s 311 Patience Counter: 1/10
11997.5s 312 Current LR: 0.000250
12128.9s 313 Epoch 12/20 - loss: 0.1487 - val_loss: 0.1414 - val_acc: 69.28%
12128.9s 314 Patience Counter: 2/10
12128.9s 315 Current LR: 0.000250
12259.8s 316 Epoch 13/20 - loss: 0.1479 - val_loss: 0.1357 - val_acc: 68.84%
12259.8s 317 val_loss improved from 0.1361 to 0.1357, saving model...
12259.8s 318 Current LR: 0.000250
12390.2s 319 Epoch 14/20 - loss: 0.1471 - val_loss: 0.1338 - val_acc: 69.18%
12390.2s 320 val_loss improved from 0.1357 to 0.1338, saving model...
12390.2s 321 Current LR: 0.000250
12520.1s 322 Epoch 15/20 - loss: 0.1464 - val_loss: 0.1327 - val_acc: 68.63%
12520.1s 323 val_loss improved from 0.1338 to 0.1327, saving model...
12520.1s 324 Current LR: 0.000250
12649.9s 325 Epoch 16/20 - loss: 0.1457 - val_loss: 0.1317 - val_acc: 69.16%
12649.9s 326 val_loss improved from 0.1327 to 0.1317, saving model...
12649.9s 327 Current LR: 0.000250
12779.2s 328 Epoch 17/20 - loss: 0.1454 - val_loss: 0.1320 - val_acc: 69.35%
12779.2s 329 Patience Counter: 1/10
12779.2s 330 Current LR: 0.000250
12908.3s 331 Epoch 18/20 - loss: 0.1449 - val_loss: 0.1331 - val_acc: 70.31%
12908.3s 332 Patience Counter: 2/10
12908.3s 333 Current LR: 0.000250
13037.0s 334 Epoch 19/20 - loss: 0.1447 - val_loss: 0.1336 - val_acc: 68.64%
13037.0s 335 Patience Counter: 3/10
13037.0s 336 Current LR: 0.000250
13165.1s 337 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:50, 132.12s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:42, 132.35s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:28, 132.29s/epoch]Training Progress:  20%|██        | 4/20 [08:49<35:20, 132.56s/epoch]Training Progress:  25%|██▌       | 5/20 [11:01<33:06, 132.41s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:51, 132.28s/epoch]Training Progress:  35%|███▌      | 7/20 [15:25<28:38, 132.17s/epoch]Training Progress:  40%|████      | 8/20 [17:37<26:25, 132.12s/epoch]Training Progress:  45%|████▌     | 9/20 [19:50<24:13, 132.11s/epoch]Training Progress:  50%|█████     | 10/20 [22:01<22:00, 132.04s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:13<19:47, 131.98s/epoch]Training Progress:  60%|██████    | 12/20 [26:25<17:34, 131.79s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:36<15:20, 131.55s/epoch]Training Progress:  70%|███████   | 14/20 [30:46<13:07, 131.20s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:56<10:53, 130.80s/epoch]Training Progress:  80%|████████  | 16/20 [35:06<08:41, 130.49s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:15<06:30, 130.14s/epoch]Training Progress:  90%|█████████ | 18/20 [39:24<04:19, 129.82s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:33<02:09, 129.49s/epoch]Training Progress: 100%|██████████| 20/20 [43:41<00:00, 129.06s/epoch]Training Progress: 100%|██████████| 20/20 [43:41<00:00, 131.07s/epoch]
13165.1s 338 Epoch 20/20 - loss: 0.1446 - val_loss: 0.1351 - val_acc: 69.01%
13165.1s 339 Patience Counter: 4/10
13165.1s 340 Current LR: 0.000125
13165.1s 341 Loaded best model with val_loss: 0.1317
13165.1s 342 Best val_acc for this run: 70.31%
13165.1s 343 
13165.1s 344 Trying hyperparameters: lr=0.0005, margin=1.5, threshold=0.4
13298.5s 345 Epoch 1/20 - loss: 3.8486 - val_loss: 0.2907 - val_acc: 64.71%
13298.5s 346 val_loss improved from inf to 0.2907, saving model...
13298.5s 347 Current LR: 0.000500
13431.2s 348 Epoch 2/20 - loss: 0.2235 - val_loss: 0.1805 - val_acc: 72.83%
13431.2s 349 val_loss improved from 0.2907 to 0.1805, saving model...
13431.2s 350 Current LR: 0.000500
13563.5s 351 Epoch 3/20 - loss: 0.1882 - val_loss: 0.1761 - val_acc: 70.82%
13563.5s 352 val_loss improved from 0.1805 to 0.1761, saving model...
13563.5s 353 Current LR: 0.000500
13696.0s 354 Epoch 4/20 - loss: 0.1776 - val_loss: 0.1653 - val_acc: 72.59%
13696.0s 355 val_loss improved from 0.1761 to 0.1653, saving model...
13696.0s 356 Current LR: 0.000500
13828.3s 357 Epoch 5/20 - loss: 0.1696 - val_loss: 0.1654 - val_acc: 73.49%
13828.3s 358 Patience Counter: 1/10
13828.3s 359 Current LR: 0.000500
13960.6s 360 Epoch 6/20 - loss: 0.1665 - val_loss: 0.1587 - val_acc: 74.89%
13960.6s 361 val_loss improved from 0.1653 to 0.1587, saving model...
13960.6s 362 Current LR: 0.000500
14092.9s 363 Epoch 7/20 - loss: 0.1661 - val_loss: 0.1548 - val_acc: 73.04%
14092.9s 364 val_loss improved from 0.1587 to 0.1548, saving model...
14092.9s 365 Current LR: 0.000500
14225.1s 366 Epoch 8/20 - loss: 0.1649 - val_loss: 0.1497 - val_acc: 74.10%
14225.1s 367 val_loss improved from 0.1548 to 0.1497, saving model...
14225.1s 368 Current LR: 0.000500
14357.5s 369 Epoch 9/20 - loss: 0.1630 - val_loss: 0.1483 - val_acc: 75.43%
14357.5s 370 val_loss improved from 0.1497 to 0.1483, saving model...
14357.5s 371 Current LR: 0.000500
14489.7s 372 Epoch 10/20 - loss: 0.1607 - val_loss: 0.1460 - val_acc: 74.65%
14489.7s 373 val_loss improved from 0.1483 to 0.1460, saving model...
14489.7s 374 Current LR: 0.000500
14621.4s 375 Epoch 11/20 - loss: 0.1599 - val_loss: 0.1518 - val_acc: 74.12%
14621.4s 376 Patience Counter: 1/10
14621.4s 377 Current LR: 0.000500
14752.4s 378 Epoch 12/20 - loss: 0.1582 - val_loss: 0.1507 - val_acc: 74.71%
14752.4s 379 Patience Counter: 2/10
14752.4s 380 Current LR: 0.000500
14882.9s 381 Epoch 13/20 - loss: 0.1578 - val_loss: 0.1453 - val_acc: 72.45%
14882.9s 382 val_loss improved from 0.1460 to 0.1453, saving model...
14882.9s 383 Current LR: 0.000500
15012.8s 384 Epoch 14/20 - loss: 0.1572 - val_loss: 0.1378 - val_acc: 75.94%
15012.8s 385 val_loss improved from 0.1453 to 0.1378, saving model...
15012.8s 386 Current LR: 0.000500
15142.3s 387 Epoch 15/20 - loss: 0.1565 - val_loss: 0.1436 - val_acc: 75.14%
15142.3s 388 Patience Counter: 1/10
15142.3s 389 Current LR: 0.000500
15271.2s 390 Epoch 16/20 - loss: 0.1560 - val_loss: 0.1485 - val_acc: 75.84%
15271.2s 391 Patience Counter: 2/10
15271.2s 392 Current LR: 0.000500
15399.8s 393 Epoch 17/20 - loss: 0.1556 - val_loss: 0.1430 - val_acc: 74.06%
15399.8s 394 Patience Counter: 3/10
15399.8s 395 Current LR: 0.000500
15528.9s 396 Epoch 18/20 - loss: 0.1557 - val_loss: 0.1455 - val_acc: 72.76%
15528.9s 397 Patience Counter: 4/10
15528.9s 398 Current LR: 0.000250
15656.6s 399 Epoch 19/20 - loss: 0.1491 - val_loss: 0.1370 - val_acc: 75.31%
15656.6s 400 val_loss improved from 0.1378 to 0.1370, saving model...
15656.6s 401 Current LR: 0.000250
15783.8s 402 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:13<42:14, 133.41s/epoch]Training Progress:  10%|█         | 2/20 [04:26<39:53, 132.97s/epoch]Training Progress:  15%|█▌        | 3/20 [06:38<37:35, 132.69s/epoch]Training Progress:  20%|██        | 4/20 [08:50<35:21, 132.59s/epoch]Training Progress:  25%|██▌       | 5/20 [11:03<33:06, 132.46s/epoch]Training Progress:  30%|███       | 6/20 [13:15<30:53, 132.42s/epoch]Training Progress:  35%|███▌      | 7/20 [15:27<28:40, 132.38s/epoch]Training Progress:  40%|████      | 8/20 [17:39<26:27, 132.33s/epoch]Training Progress:  45%|████▌     | 9/20 [19:52<24:15, 132.35s/epoch]Training Progress:  50%|█████     | 10/20 [22:04<22:03, 132.31s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:16<19:48, 132.08s/epoch]Training Progress:  60%|██████    | 12/20 [26:27<17:34, 131.77s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:37<15:19, 131.42s/epoch]Training Progress:  70%|███████   | 14/20 [30:47<13:05, 130.94s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:57<10:52, 130.50s/epoch]Training Progress:  80%|████████  | 16/20 [35:06<08:40, 130.04s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:14<06:28, 129.60s/epoch]Training Progress:  90%|█████████ | 18/20 [39:23<04:18, 129.45s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:31<02:08, 128.92s/epoch]Training Progress: 100%|██████████| 20/20 [43:38<00:00, 128.40s/epoch]Training Progress: 100%|██████████| 20/20 [43:38<00:00, 130.93s/epoch]
15783.8s 403 Epoch 20/20 - loss: 0.1481 - val_loss: 0.1383 - val_acc: 75.33%
15783.8s 404 Patience Counter: 1/10
15783.8s 405 Current LR: 0.000250
15783.8s 406 Loaded best model with val_loss: 0.1370
15783.8s 407 Best val_acc for this run: 75.94%
15783.8s 408 
15783.8s 409 Trying hyperparameters: lr=0.0005, margin=1.5, threshold=0.45
15916.1s 410 Epoch 1/20 - loss: 3.6677 - val_loss: 0.2765 - val_acc: 67.24%
15916.1s 411 val_loss improved from inf to 0.2765, saving model...
15916.1s 412 Current LR: 0.000500
16048.4s 413 Epoch 2/20 - loss: 0.2189 - val_loss: 0.1750 - val_acc: 73.88%
16048.4s 414 val_loss improved from 0.2765 to 0.1750, saving model...
16048.4s 415 Current LR: 0.000500
16180.5s 416 Epoch 3/20 - loss: 0.1825 - val_loss: 0.1597 - val_acc: 75.23%
16180.5s 417 val_loss improved from 0.1750 to 0.1597, saving model...
16180.5s 418 Current LR: 0.000500
16312.6s 419 Epoch 4/20 - loss: 0.1710 - val_loss: 0.1562 - val_acc: 78.23%
16312.6s 420 val_loss improved from 0.1597 to 0.1562, saving model...
16312.6s 421 Current LR: 0.000500
16444.7s 422 Epoch 5/20 - loss: 0.1668 - val_loss: 0.1476 - val_acc: 76.10%
16444.7s 423 val_loss improved from 0.1562 to 0.1476, saving model...
16444.7s 424 Current LR: 0.000500
16576.9s 425 Epoch 6/20 - loss: 0.1653 - val_loss: 0.1536 - val_acc: 77.82%
16576.9s 426 Patience Counter: 1/10
16576.9s 427 Current LR: 0.000500
16708.8s 428 Epoch 7/20 - loss: 0.1648 - val_loss: 0.1513 - val_acc: 75.69%
16708.8s 429 Patience Counter: 2/10
16708.8s 430 Current LR: 0.000500
16840.4s 431 Epoch 8/20 - loss: 0.1637 - val_loss: 0.1534 - val_acc: 76.05%
16840.4s 432 Patience Counter: 3/10
16840.4s 433 Current LR: 0.000500
16972.3s 434 Epoch 9/20 - loss: 0.1632 - val_loss: 0.1524 - val_acc: 77.15%
16972.3s 435 Patience Counter: 4/10
16972.3s 436 Current LR: 0.000250
17104.1s 437 Epoch 10/20 - loss: 0.1538 - val_loss: 0.1407 - val_acc: 78.08%
17104.1s 438 val_loss improved from 0.1476 to 0.1407, saving model...
17104.1s 439 Current LR: 0.000250
17235.7s 440 Epoch 11/20 - loss: 0.1514 - val_loss: 0.1419 - val_acc: 76.90%
17235.7s 441 Patience Counter: 1/10
17235.7s 442 Current LR: 0.000250
17367.0s 443 Epoch 12/20 - loss: 0.1492 - val_loss: 0.1342 - val_acc: 78.85%
17367.0s 444 val_loss improved from 0.1407 to 0.1342, saving model...
17367.0s 445 Current LR: 0.000250
17497.6s 446 Epoch 13/20 - loss: 0.1477 - val_loss: 0.1390 - val_acc: 77.45%
17497.6s 447 Patience Counter: 1/10
17497.6s 448 Current LR: 0.000250
17627.9s 449 Epoch 14/20 - loss: 0.1476 - val_loss: 0.1345 - val_acc: 79.03%
17627.9s 450 Patience Counter: 2/10
17627.9s 451 Current LR: 0.000250
17758.0s 452 Epoch 15/20 - loss: 0.1461 - val_loss: 0.1381 - val_acc: 78.76%
17758.0s 453 Patience Counter: 3/10
17758.0s 454 Current LR: 0.000250
17887.3s 455 Epoch 16/20 - loss: 0.1458 - val_loss: 0.1346 - val_acc: 79.36%
17887.3s 456 Patience Counter: 4/10
17887.3s 457 Current LR: 0.000125
18016.3s 458 Epoch 17/20 - loss: 0.1409 - val_loss: 0.1293 - val_acc: 79.48%
18016.3s 459 val_loss improved from 0.1342 to 0.1293, saving model...
18016.3s 460 Current LR: 0.000125
18145.8s 461 Epoch 18/20 - loss: 0.1400 - val_loss: 0.1286 - val_acc: 79.83%
18145.8s 462 val_loss improved from 0.1293 to 0.1286, saving model...
18145.8s 463 Current LR: 0.000125
18274.8s 464 Epoch 19/20 - loss: 0.1396 - val_loss: 0.1256 - val_acc: 79.26%
18274.8s 465 val_loss improved from 0.1286 to 0.1256, saving model...
18274.8s 466 Current LR: 0.000125
18403.3s 467 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:53, 132.28s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:41, 132.30s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:27, 132.20s/epoch]Training Progress:  20%|██        | 4/20 [08:48<35:14, 132.15s/epoch]Training Progress:  25%|██▌       | 5/20 [11:00<33:02, 132.14s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:49, 132.14s/epoch]Training Progress:  35%|███▌      | 7/20 [15:24<28:36, 132.07s/epoch]Training Progress:  40%|████      | 8/20 [17:36<26:23, 131.93s/epoch]Training Progress:  45%|████▌     | 9/20 [19:48<24:10, 131.90s/epoch]Training Progress:  50%|█████     | 10/20 [22:00<21:59, 131.91s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:11<19:46, 131.78s/epoch]Training Progress:  60%|██████    | 12/20 [26:23<17:33, 131.64s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:33<15:19, 131.32s/epoch]Training Progress:  70%|███████   | 14/20 [30:44<13:06, 131.03s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:54<10:53, 130.73s/epoch]Training Progress:  80%|████████  | 16/20 [35:03<08:41, 130.31s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:12<06:29, 129.93s/epoch]Training Progress:  90%|█████████ | 18/20 [39:21<04:19, 129.77s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:30<02:09, 129.55s/epoch]Training Progress: 100%|██████████| 20/20 [43:39<00:00, 129.22s/epoch]Training Progress: 100%|██████████| 20/20 [43:39<00:00, 130.97s/epoch]
18403.3s 468 Epoch 20/20 - loss: 0.1388 - val_loss: 0.1294 - val_acc: 79.72%
18403.3s 469 Patience Counter: 1/10
18403.3s 470 Current LR: 0.000125
18403.3s 471 Loaded best model with val_loss: 0.1256
18403.3s 472 Best val_acc for this run: 79.83%
18403.3s 473 
18403.3s 474 Trying hyperparameters: lr=0.0005, margin=1.5, threshold=0.5
18535.5s 475 Epoch 1/20 - loss: 3.8790 - val_loss: 0.2985 - val_acc: 65.12%
18535.5s 476 val_loss improved from inf to 0.2985, saving model...
18535.5s 477 Current LR: 0.000500
18667.9s 478 Epoch 2/20 - loss: 0.2212 - val_loss: 0.1798 - val_acc: 75.55%
18667.9s 479 val_loss improved from 0.2985 to 0.1798, saving model...
18667.9s 480 Current LR: 0.000500
18800.1s 481 Epoch 3/20 - loss: 0.1867 - val_loss: 0.1684 - val_acc: 76.44%
18800.1s 482 val_loss improved from 0.1798 to 0.1684, saving model...
18800.1s 483 Current LR: 0.000500
18932.3s 484 Epoch 4/20 - loss: 0.1751 - val_loss: 0.1620 - val_acc: 79.57%
18932.3s 485 val_loss improved from 0.1684 to 0.1620, saving model...
18932.3s 486 Current LR: 0.000500
19064.2s 487 Epoch 5/20 - loss: 0.1674 - val_loss: 0.1473 - val_acc: 77.18%
19064.2s 488 val_loss improved from 0.1620 to 0.1473, saving model...
19064.2s 489 Current LR: 0.000500
19195.9s 490 Epoch 6/20 - loss: 0.1660 - val_loss: 0.1520 - val_acc: 78.97%
19195.9s 491 Patience Counter: 1/10
19195.9s 492 Current LR: 0.000500
19327.8s 493 Epoch 7/20 - loss: 0.1654 - val_loss: 0.1509 - val_acc: 78.33%
19327.8s 494 Patience Counter: 2/10
19327.8s 495 Current LR: 0.000500
19459.7s 496 Epoch 8/20 - loss: 0.1632 - val_loss: 0.1489 - val_acc: 78.20%
19459.7s 497 Patience Counter: 3/10
19459.7s 498 Current LR: 0.000500
19591.6s 499 Epoch 9/20 - loss: 0.1629 - val_loss: 0.1448 - val_acc: 79.24%
19591.6s 500 val_loss improved from 0.1473 to 0.1448, saving model...
19591.6s 501 Current LR: 0.000500
19723.3s 502 Epoch 10/20 - loss: 0.1605 - val_loss: 0.1475 - val_acc: 79.11%
19723.3s 503 Patience Counter: 1/10
19723.3s 504 Current LR: 0.000500
19854.7s 505 Epoch 11/20 - loss: 0.1586 - val_loss: 0.1493 - val_acc: 78.78%
19854.7s 506 Patience Counter: 2/10
19854.7s 507 Current LR: 0.000500
19985.4s 508 Epoch 12/20 - loss: 0.1574 - val_loss: 0.1440 - val_acc: 77.78%
19985.4s 509 val_loss improved from 0.1448 to 0.1440, saving model...
19985.4s 510 Current LR: 0.000500
20116.3s 511 Epoch 13/20 - loss: 0.1567 - val_loss: 0.1438 - val_acc: 78.96%
20116.3s 512 val_loss improved from 0.1440 to 0.1438, saving model...
20116.3s 513 Current LR: 0.000500
20246.1s 514 Epoch 14/20 - loss: 0.1559 - val_loss: 0.1444 - val_acc: 79.61%
20246.1s 515 Patience Counter: 1/10
20246.1s 516 Current LR: 0.000500
20375.1s 517 Epoch 15/20 - loss: 0.1561 - val_loss: 0.1510 - val_acc: 78.19%
20375.1s 518 Patience Counter: 2/10
20375.1s 519 Current LR: 0.000500
20503.6s 520 Epoch 16/20 - loss: 0.1552 - val_loss: 0.1420 - val_acc: 79.66%
20503.6s 521 val_loss improved from 0.1438 to 0.1420, saving model...
20503.6s 522 Current LR: 0.000500
20631.9s 523 Epoch 17/20 - loss: 0.1540 - val_loss: 0.1381 - val_acc: 80.24%
20631.9s 524 val_loss improved from 0.1420 to 0.1381, saving model...
20631.9s 525 Current LR: 0.000500
20759.7s 526 Epoch 18/20 - loss: 0.1525 - val_loss: 0.1440 - val_acc: 78.71%
20759.7s 527 Patience Counter: 1/10
20759.7s 528 Current LR: 0.000500
20887.3s 529 Epoch 19/20 - loss: 0.1531 - val_loss: 0.1364 - val_acc: 80.33%
20887.3s 530 val_loss improved from 0.1381 to 0.1364, saving model...
20887.3s 531 Current LR: 0.000500
21014.8s 532 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:53, 132.27s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:41, 132.31s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:28, 132.28s/epoch]Training Progress:  20%|██        | 4/20 [08:48<35:15, 132.21s/epoch]Training Progress:  25%|██▌       | 5/20 [11:00<33:01, 132.12s/epoch]Training Progress:  30%|███       | 6/20 [13:12<30:47, 131.98s/epoch]Training Progress:  35%|███▌      | 7/20 [15:24<28:35, 131.96s/epoch]Training Progress:  40%|████      | 8/20 [17:36<26:23, 131.92s/epoch]Training Progress:  45%|████▌     | 9/20 [19:48<24:11, 131.95s/epoch]Training Progress:  50%|█████     | 10/20 [21:59<21:58, 131.85s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:11<19:45, 131.69s/epoch]Training Progress:  60%|██████    | 12/20 [26:22<17:31, 131.41s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:33<15:18, 131.26s/epoch]Training Progress:  70%|███████   | 14/20 [30:42<13:04, 130.80s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:51<10:51, 130.25s/epoch]Training Progress:  80%|████████  | 16/20 [35:00<08:39, 129.77s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:08<06:27, 129.30s/epoch]Training Progress:  90%|█████████ | 18/20 [39:16<04:17, 128.85s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:24<02:08, 128.49s/epoch]Training Progress: 100%|██████████| 20/20 [43:31<00:00, 128.19s/epoch]Training Progress: 100%|██████████| 20/20 [43:31<00:00, 130.58s/epoch]
21014.8s 533 Epoch 20/20 - loss: 0.1524 - val_loss: 0.1370 - val_acc: 80.21%
21014.8s 534 Patience Counter: 1/10
21014.8s 535 Current LR: 0.000500
21014.8s 536 Loaded best model with val_loss: 0.1364
21014.8s 537 Best val_acc for this run: 80.33%
21014.8s 538 
21014.8s 539 Trying hyperparameters: lr=0.001, margin=1.0, threshold=0.3
21146.9s 540 Epoch 1/20 - loss: 2.3666 - val_loss: 0.1177 - val_acc: 68.24%
21146.9s 541 val_loss improved from inf to 0.1177, saving model...
21146.9s 542 Current LR: 0.001000
21279.1s 543 Epoch 2/20 - loss: 0.0940 - val_loss: 0.0815 - val_acc: 73.76%
21279.1s 544 val_loss improved from 0.1177 to 0.0815, saving model...
21279.1s 545 Current LR: 0.001000
21411.3s 546 Epoch 3/20 - loss: 0.0850 - val_loss: 0.0822 - val_acc: 73.65%
21411.3s 547 Patience Counter: 1/10
21411.3s 548 Current LR: 0.001000
21543.0s 549 Epoch 4/20 - loss: 0.0815 - val_loss: 0.0927 - val_acc: 76.05%
21543.0s 550 Patience Counter: 2/10
21543.0s 551 Current LR: 0.001000
21675.0s 552 Epoch 5/20 - loss: 0.0807 - val_loss: 0.0791 - val_acc: 74.34%
21675.0s 553 val_loss improved from 0.0815 to 0.0791, saving model...
21675.0s 554 Current LR: 0.001000
21806.9s 555 Epoch 6/20 - loss: 0.0805 - val_loss: 0.0749 - val_acc: 75.65%
21806.9s 556 val_loss improved from 0.0791 to 0.0749, saving model...
21806.9s 557 Current LR: 0.001000
21938.9s 558 Epoch 7/20 - loss: 0.0800 - val_loss: 0.0804 - val_acc: 76.23%
21938.9s 559 Patience Counter: 1/10
21938.9s 560 Current LR: 0.001000
22070.6s 561 Epoch 8/20 - loss: 0.0793 - val_loss: 0.0724 - val_acc: 73.68%
22070.6s 562 val_loss improved from 0.0749 to 0.0724, saving model...
22070.6s 563 Current LR: 0.001000
22201.8s 564 Epoch 9/20 - loss: 0.0787 - val_loss: 0.0889 - val_acc: 75.50%
22201.8s 565 Patience Counter: 1/10
22201.8s 566 Current LR: 0.001000
22332.8s 567 Epoch 10/20 - loss: 0.0783 - val_loss: 0.0775 - val_acc: 74.95%
22332.8s 568 Patience Counter: 2/10
22332.9s 569 Current LR: 0.001000
22463.0s 570 Epoch 11/20 - loss: 0.0782 - val_loss: 0.0726 - val_acc: 74.00%
22463.0s 571 Patience Counter: 3/10
22463.0s 572 Current LR: 0.001000
22592.5s 573 Epoch 12/20 - loss: 0.0782 - val_loss: 0.0714 - val_acc: 76.83%
22592.5s 574 val_loss improved from 0.0724 to 0.0714, saving model...
22592.5s 575 Current LR: 0.001000
22721.6s 576 Epoch 13/20 - loss: 0.0777 - val_loss: 0.0777 - val_acc: 74.71%
22721.6s 577 Patience Counter: 1/10
22721.6s 578 Current LR: 0.001000
22849.8s 579 Epoch 14/20 - loss: 0.0777 - val_loss: 0.0676 - val_acc: 76.36%
22849.8s 580 val_loss improved from 0.0714 to 0.0676, saving model...
22849.8s 581 Current LR: 0.001000
22977.7s 582 Epoch 15/20 - loss: 0.0775 - val_loss: 0.0744 - val_acc: 73.02%
22977.7s 583 Patience Counter: 1/10
22977.7s 584 Current LR: 0.001000
23105.2s 585 Epoch 16/20 - loss: 0.0774 - val_loss: 0.0740 - val_acc: 73.15%
23105.2s 586 Patience Counter: 2/10
23105.2s 587 Current LR: 0.001000
23232.5s 588 Epoch 17/20 - loss: 0.0774 - val_loss: 0.0764 - val_acc: 74.45%
23232.5s 589 Patience Counter: 3/10
23232.5s 590 Current LR: 0.001000
23360.0s 591 Epoch 18/20 - loss: 0.0770 - val_loss: 0.0763 - val_acc: 74.76%
23360.0s 592 Patience Counter: 4/10
23360.0s 593 Current LR: 0.000500
23486.7s 594 Epoch 19/20 - loss: 0.0744 - val_loss: 0.0665 - val_acc: 76.19%
23486.7s 595 val_loss improved from 0.0676 to 0.0665, saving model...
23486.7s 596 Current LR: 0.000500
23613.3s 597 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:49, 132.08s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:38, 132.13s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:26, 132.13s/epoch]Training Progress:  20%|██        | 4/20 [08:48<35:11, 131.98s/epoch]Training Progress:  25%|██▌       | 5/20 [11:00<32:59, 131.99s/epoch]Training Progress:  30%|███       | 6/20 [13:12<30:47, 131.98s/epoch]Training Progress:  35%|███▌      | 7/20 [15:24<28:35, 131.96s/epoch]Training Progress:  40%|████      | 8/20 [17:35<26:22, 131.87s/epoch]Training Progress:  45%|████▌     | 9/20 [19:46<24:08, 131.65s/epoch]Training Progress:  50%|█████     | 10/20 [21:57<21:54, 131.46s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:08<19:39, 131.08s/epoch]Training Progress:  60%|██████    | 12/20 [26:17<17:24, 130.62s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:26<15:10, 130.10s/epoch]Training Progress:  70%|███████   | 14/20 [30:34<12:57, 129.56s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:42<10:45, 129.04s/epoch]Training Progress:  80%|████████  | 16/20 [34:50<08:34, 128.60s/epoch]Training Progress:  85%|████████▌ | 17/20 [36:57<06:24, 128.20s/epoch]Training Progress:  90%|█████████ | 18/20 [39:05<04:15, 127.99s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:11<02:07, 127.62s/epoch]Training Progress: 100%|██████████| 20/20 [43:18<00:00, 127.30s/epoch]Training Progress: 100%|██████████| 20/20 [43:18<00:00, 129.92s/epoch]
23613.3s 598 Epoch 20/20 - loss: 0.0744 - val_loss: 0.0708 - val_acc: 77.75%
23613.3s 599 Patience Counter: 1/10
23613.3s 600 Current LR: 0.000500
23613.3s 601 Loaded best model with val_loss: 0.0665
23613.3s 602 Best val_acc for this run: 77.75%
23613.3s 603 
23613.3s 604 Trying hyperparameters: lr=0.001, margin=1.0, threshold=0.4
23745.6s 605 Epoch 1/20 - loss: 2.2997 - val_loss: 0.1128 - val_acc: 67.64%
23745.6s 606 val_loss improved from inf to 0.1128, saving model...
23745.6s 607 Current LR: 0.001000
23878.0s 608 Epoch 2/20 - loss: 0.0937 - val_loss: 0.0787 - val_acc: 77.30%
23878.0s 609 val_loss improved from 0.1128 to 0.0787, saving model...
23878.0s 610 Current LR: 0.001000
24010.3s 611 Epoch 3/20 - loss: 0.0855 - val_loss: 0.0790 - val_acc: 78.11%
24010.3s 612 Patience Counter: 1/10
24010.3s 613 Current LR: 0.001000
24142.5s 614 Epoch 4/20 - loss: 0.0825 - val_loss: 0.0760 - val_acc: 78.10%
24142.5s 615 val_loss improved from 0.0787 to 0.0760, saving model...
24142.5s 616 Current LR: 0.001000
24274.7s 617 Epoch 5/20 - loss: 0.0819 - val_loss: 0.0806 - val_acc: 76.69%
24274.7s 618 Patience Counter: 1/10
24274.7s 619 Current LR: 0.001000
24406.9s 620 Epoch 6/20 - loss: 0.0819 - val_loss: 0.0879 - val_acc: 77.12%
24406.9s 621 Patience Counter: 2/10
24406.9s 622 Current LR: 0.001000
24539.2s 623 Epoch 7/20 - loss: 0.0814 - val_loss: 0.0784 - val_acc: 76.19%
24539.2s 624 Patience Counter: 3/10
24539.2s 625 Current LR: 0.001000
24670.7s 626 Epoch 8/20 - loss: 0.0815 - val_loss: 0.0843 - val_acc: 79.07%
24670.7s 627 Patience Counter: 4/10
24670.7s 628 Current LR: 0.000500
24801.7s 629 Epoch 9/20 - loss: 0.0783 - val_loss: 0.0769 - val_acc: 79.32%
24801.7s 630 Patience Counter: 5/10
24801.7s 631 Current LR: 0.000500
24932.6s 632 Epoch 10/20 - loss: 0.0771 - val_loss: 0.0733 - val_acc: 80.31%
24932.6s 633 val_loss improved from 0.0760 to 0.0733, saving model...
24932.6s 634 Current LR: 0.000500
25063.1s 635 Epoch 11/20 - loss: 0.0762 - val_loss: 0.0696 - val_acc: 79.70%
25063.1s 636 val_loss improved from 0.0733 to 0.0696, saving model...
25063.1s 637 Current LR: 0.000500
25193.3s 638 Epoch 12/20 - loss: 0.0756 - val_loss: 0.0699 - val_acc: 80.79%
25193.3s 639 Patience Counter: 1/10
25193.3s 640 Current LR: 0.000500
25323.0s 641 Epoch 13/20 - loss: 0.0753 - val_loss: 0.0692 - val_acc: 80.03%
25323.0s 642 val_loss improved from 0.0696 to 0.0692, saving model...
25323.0s 643 Current LR: 0.000500
25452.1s 644 Epoch 14/20 - loss: 0.0750 - val_loss: 0.0694 - val_acc: 80.10%
25452.1s 645 Patience Counter: 1/10
25452.1s 646 Current LR: 0.000500
25580.8s 647 Epoch 15/20 - loss: 0.0750 - val_loss: 0.0731 - val_acc: 79.23%
25580.8s 648 Patience Counter: 2/10
25580.8s 649 Current LR: 0.000500
25709.8s 650 Epoch 16/20 - loss: 0.0747 - val_loss: 0.0743 - val_acc: 78.61%
25709.8s 651 Patience Counter: 3/10
25709.8s 652 Current LR: 0.000500
25837.3s 653 Epoch 17/20 - loss: 0.0746 - val_loss: 0.0757 - val_acc: 78.67%
25837.3s 654 Patience Counter: 4/10
25837.3s 655 Current LR: 0.000250
25964.5s 656 Epoch 18/20 - loss: 0.0725 - val_loss: 0.0665 - val_acc: 80.64%
25964.5s 657 val_loss improved from 0.0692 to 0.0665, saving model...
25964.5s 658 Current LR: 0.000250
26091.7s 659 Epoch 19/20 - loss: 0.0724 - val_loss: 0.0667 - val_acc: 80.85%
26091.7s 660 Patience Counter: 1/10
26091.7s 661 Current LR: 0.000250
26218.3s 662 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:53, 132.30s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:42, 132.36s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:29, 132.31s/epoch]Training Progress:  20%|██        | 4/20 [08:49<35:16, 132.28s/epoch]Training Progress:  25%|██▌       | 5/20 [11:01<33:03, 132.21s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:51, 132.22s/epoch]Training Progress:  35%|███▌      | 7/20 [15:25<28:39, 132.24s/epoch]Training Progress:  40%|████      | 8/20 [17:37<26:24, 132.01s/epoch]Training Progress:  45%|████▌     | 9/20 [19:48<24:08, 131.70s/epoch]Training Progress:  50%|█████     | 10/20 [21:59<21:54, 131.46s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:09<19:40, 131.17s/epoch]Training Progress:  60%|██████    | 12/20 [26:19<17:26, 130.86s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:29<15:13, 130.51s/epoch]Training Progress:  70%|███████   | 14/20 [30:38<13:00, 130.06s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:47<10:48, 129.64s/epoch]Training Progress:  80%|████████  | 16/20 [34:56<08:37, 129.42s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:03<06:26, 128.90s/epoch]Training Progress:  90%|█████████ | 18/20 [39:11<04:16, 128.40s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:18<02:08, 128.01s/epoch]Training Progress: 100%|██████████| 20/20 [43:24<00:00, 127.61s/epoch]Training Progress: 100%|██████████| 20/20 [43:24<00:00, 130.25s/epoch]
26218.3s 663 Epoch 20/20 - loss: 0.0721 - val_loss: 0.0686 - val_acc: 81.11%
26218.3s 664 Patience Counter: 2/10
26218.3s 665 Current LR: 0.000250
26218.3s 666 Loaded best model with val_loss: 0.0665
26218.3s 667 Best val_acc for this run: 81.11%
26218.3s 668 
26218.3s 669 Trying hyperparameters: lr=0.001, margin=1.0, threshold=0.45
26350.6s 670 Epoch 1/20 - loss: 2.4982 - val_loss: 0.1094 - val_acc: 68.97%
26350.6s 671 val_loss improved from inf to 0.1094, saving model...
26350.6s 672 Current LR: 0.001000
26482.7s 673 Epoch 2/20 - loss: 0.0931 - val_loss: 0.0809 - val_acc: 77.28%
26482.7s 674 val_loss improved from 0.1094 to 0.0809, saving model...
26482.7s 675 Current LR: 0.001000
26614.9s 676 Epoch 3/20 - loss: 0.0847 - val_loss: 0.0766 - val_acc: 78.76%
26614.9s 677 val_loss improved from 0.0809 to 0.0766, saving model...
26614.9s 678 Current LR: 0.001000
26747.0s 679 Epoch 4/20 - loss: 0.0811 - val_loss: 0.0732 - val_acc: 80.45%
26747.0s 680 val_loss improved from 0.0766 to 0.0732, saving model...
26747.0s 681 Current LR: 0.001000
26879.5s 682 Epoch 5/20 - loss: 0.0792 - val_loss: 0.0720 - val_acc: 80.59%
26879.5s 683 val_loss improved from 0.0732 to 0.0720, saving model...
26879.5s 684 Current LR: 0.001000
27011.6s 685 Epoch 6/20 - loss: 0.0783 - val_loss: 0.0767 - val_acc: 79.13%
27011.6s 686 Patience Counter: 1/10
27011.6s 687 Current LR: 0.001000
27143.8s 688 Epoch 7/20 - loss: 0.0779 - val_loss: 0.0738 - val_acc: 79.59%
27143.8s 689 Patience Counter: 2/10
27143.8s 690 Current LR: 0.001000
27275.7s 691 Epoch 8/20 - loss: 0.0781 - val_loss: 0.0763 - val_acc: 79.38%
27275.7s 692 Patience Counter: 3/10
27275.7s 693 Current LR: 0.001000
27406.9s 694 Epoch 9/20 - loss: 0.0774 - val_loss: 0.0825 - val_acc: 77.93%
27406.9s 695 Patience Counter: 4/10
27406.9s 696 Current LR: 0.000500
27537.8s 697 Epoch 10/20 - loss: 0.0741 - val_loss: 0.0663 - val_acc: 82.50%
27537.8s 698 val_loss improved from 0.0720 to 0.0663, saving model...
27537.8s 699 Current LR: 0.000500
27668.7s 700 Epoch 11/20 - loss: 0.0739 - val_loss: 0.0678 - val_acc: 81.97%
27668.7s 701 Patience Counter: 1/10
27668.7s 702 Current LR: 0.000500
27799.1s 703 Epoch 12/20 - loss: 0.0738 - val_loss: 0.0668 - val_acc: 82.51%
27799.1s 704 Patience Counter: 2/10
27799.1s 705 Current LR: 0.000500
27929.2s 706 Epoch 13/20 - loss: 0.0736 - val_loss: 0.0700 - val_acc: 81.03%
27929.2s 707 Patience Counter: 3/10
27929.2s 708 Current LR: 0.000500
28059.9s 709 Epoch 14/20 - loss: 0.0734 - val_loss: 0.0670 - val_acc: 82.49%
28059.9s 710 Patience Counter: 4/10
28059.9s 711 Current LR: 0.000250
28189.0s 712 Epoch 15/20 - loss: 0.0711 - val_loss: 0.0655 - val_acc: 82.92%
28189.0s 713 val_loss improved from 0.0663 to 0.0655, saving model...
28189.0s 714 Current LR: 0.000250
28317.8s 715 Epoch 16/20 - loss: 0.0706 - val_loss: 0.0665 - val_acc: 82.22%
28317.8s 716 Patience Counter: 1/10
28317.8s 717 Current LR: 0.000250
28446.1s 718 Epoch 17/20 - loss: 0.0707 - val_loss: 0.0639 - val_acc: 82.93%
28446.1s 719 val_loss improved from 0.0655 to 0.0639, saving model...
28446.1s 720 Current LR: 0.000250
28573.9s 721 Epoch 18/20 - loss: 0.0704 - val_loss: 0.0638 - val_acc: 83.04%
28573.9s 722 val_loss improved from 0.0639 to 0.0638, saving model...
28573.9s 723 Current LR: 0.000250
28701.5s 724 Epoch 19/20 - loss: 0.0702 - val_loss: 0.0641 - val_acc: 82.89%
28701.5s 725 Patience Counter: 1/10
28701.5s 726 Current LR: 0.000250
28828.4s 727 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:53, 132.29s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:39, 132.17s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:27, 132.20s/epoch]Training Progress:  20%|██        | 4/20 [08:48<35:14, 132.16s/epoch]Training Progress:  25%|██▌       | 5/20 [11:01<33:03, 132.25s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:50, 132.19s/epoch]Training Progress:  35%|███▌      | 7/20 [15:25<28:38, 132.19s/epoch]Training Progress:  40%|████      | 8/20 [17:37<26:25, 132.09s/epoch]Training Progress:  45%|████▌     | 9/20 [19:48<24:09, 131.80s/epoch]Training Progress:  50%|█████     | 10/20 [21:59<21:55, 131.58s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:10<19:41, 131.33s/epoch]Training Progress:  60%|██████    | 12/20 [26:20<17:28, 131.07s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:30<15:15, 130.78s/epoch]Training Progress:  70%|███████   | 14/20 [30:41<13:04, 130.71s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:50<10:51, 130.27s/epoch]Training Progress:  80%|████████  | 16/20 [34:59<08:39, 129.82s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:07<06:28, 129.36s/epoch]Training Progress:  90%|█████████ | 18/20 [39:15<04:17, 128.91s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:23<02:08, 128.48s/epoch]Training Progress: 100%|██████████| 20/20 [43:30<00:00, 128.04s/epoch]Training Progress: 100%|██████████| 20/20 [43:30<00:00, 130.50s/epoch]
28828.4s 728 Epoch 20/20 - loss: 0.0703 - val_loss: 0.0637 - val_acc: 83.09%
28828.4s 729 val_loss improved from 0.0638 to 0.0637, saving model...
28828.4s 730 Current LR: 0.000250
28828.4s 731 Loaded best model with val_loss: 0.0637
28828.4s 732 Best val_acc for this run: 83.09%
28828.4s 733 
28828.4s 734 Trying hyperparameters: lr=0.001, margin=1.0, threshold=0.5
28960.5s 735 Epoch 1/20 - loss: 2.3654 - val_loss: 0.1289 - val_acc: 58.54%
28960.5s 736 val_loss improved from inf to 0.1289, saving model...
28960.5s 737 Current LR: 0.001000
29093.1s 738 Epoch 2/20 - loss: 0.0944 - val_loss: 0.0805 - val_acc: 76.88%
29093.1s 739 val_loss improved from 0.1289 to 0.0805, saving model...
29093.1s 740 Current LR: 0.001000
29225.4s 741 Epoch 3/20 - loss: 0.0840 - val_loss: 0.0769 - val_acc: 78.75%
29225.4s 742 val_loss improved from 0.0805 to 0.0769, saving model...
29225.4s 743 Current LR: 0.001000
29357.4s 744 Epoch 4/20 - loss: 0.0815 - val_loss: 0.0750 - val_acc: 79.36%
29357.4s 745 val_loss improved from 0.0769 to 0.0750, saving model...
29357.4s 746 Current LR: 0.001000
29489.4s 747 Epoch 5/20 - loss: 0.0809 - val_loss: 0.0743 - val_acc: 79.88%
29489.4s 748 val_loss improved from 0.0750 to 0.0743, saving model...
29489.4s 749 Current LR: 0.001000
29621.5s 750 Epoch 6/20 - loss: 0.0799 - val_loss: 0.0724 - val_acc: 80.21%
29621.5s 751 val_loss improved from 0.0743 to 0.0724, saving model...
29621.5s 752 Current LR: 0.001000
29753.5s 753 Epoch 7/20 - loss: 0.0796 - val_loss: 0.0713 - val_acc: 80.86%
29753.5s 754 val_loss improved from 0.0724 to 0.0713, saving model...
29753.5s 755 Current LR: 0.001000
29885.3s 756 Epoch 8/20 - loss: 0.0790 - val_loss: 0.0759 - val_acc: 78.80%
29885.3s 757 Patience Counter: 1/10
29885.3s 758 Current LR: 0.001000
30016.4s 759 Epoch 9/20 - loss: 0.0788 - val_loss: 0.0756 - val_acc: 78.90%
30016.4s 760 Patience Counter: 2/10
30016.4s 761 Current LR: 0.001000
30147.2s 762 Epoch 10/20 - loss: 0.0779 - val_loss: 0.0719 - val_acc: 80.55%
30147.2s 763 Patience Counter: 3/10
30147.2s 764 Current LR: 0.001000
30277.9s 765 Epoch 11/20 - loss: 0.0782 - val_loss: 0.0741 - val_acc: 79.55%
30277.9s 766 Patience Counter: 4/10
30277.9s 767 Current LR: 0.000500
30407.7s 768 Epoch 12/20 - loss: 0.0746 - val_loss: 0.0701 - val_acc: 81.37%
30407.7s 769 val_loss improved from 0.0713 to 0.0701, saving model...
30407.7s 770 Current LR: 0.000500
30537.2s 771 Epoch 13/20 - loss: 0.0743 - val_loss: 0.0711 - val_acc: 80.63%
30537.2s 772 Patience Counter: 1/10
30537.2s 773 Current LR: 0.000500
30666.0s 774 Epoch 14/20 - loss: 0.0742 - val_loss: 0.0727 - val_acc: 80.29%
30666.0s 775 Patience Counter: 2/10
30666.0s 776 Current LR: 0.000500
30794.5s 777 Epoch 15/20 - loss: 0.0743 - val_loss: 0.0692 - val_acc: 81.26%
30794.5s 778 val_loss improved from 0.0701 to 0.0692, saving model...
30794.5s 779 Current LR: 0.000500
30922.4s 780 Epoch 16/20 - loss: 0.0739 - val_loss: 0.0689 - val_acc: 81.40%
30922.4s 781 val_loss improved from 0.0692 to 0.0689, saving model...
30922.4s 782 Current LR: 0.000500
31050.0s 783 Epoch 17/20 - loss: 0.0738 - val_loss: 0.0734 - val_acc: 80.08%
31050.0s 784 Patience Counter: 1/10
31050.0s 785 Current LR: 0.000500
31176.9s 786 Epoch 18/20 - loss: 0.0736 - val_loss: 0.0722 - val_acc: 80.41%
31176.9s 787 Patience Counter: 2/10
31176.9s 788 Current LR: 0.000500
31303.9s 789 Epoch 19/20 - loss: 0.0733 - val_loss: 0.0694 - val_acc: 81.32%
31303.9s 790 Patience Counter: 3/10
31303.9s 791 Current LR: 0.000500
31431.4s 792 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:48, 132.04s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:42, 132.35s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:29, 132.33s/epoch]Training Progress:  20%|██        | 4/20 [08:48<35:15, 132.21s/epoch]Training Progress:  25%|██▌       | 5/20 [11:00<33:02, 132.14s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:49, 132.13s/epoch]Training Progress:  35%|███▌      | 7/20 [15:25<28:37, 132.09s/epoch]Training Progress:  40%|████      | 8/20 [17:36<26:23, 131.98s/epoch]Training Progress:  45%|████▌     | 9/20 [19:47<24:08, 131.70s/epoch]Training Progress:  50%|█████     | 10/20 [21:58<21:54, 131.41s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:09<19:40, 131.19s/epoch]Training Progress:  60%|██████    | 12/20 [26:19<17:26, 130.79s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:28<15:12, 130.37s/epoch]Training Progress:  70%|███████   | 14/20 [30:37<12:59, 129.91s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:46<10:47, 129.50s/epoch]Training Progress:  80%|████████  | 16/20 [34:53<08:36, 129.03s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:01<06:25, 128.56s/epoch]Training Progress:  90%|█████████ | 18/20 [39:08<04:16, 128.08s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:15<02:07, 127.67s/epoch]Training Progress: 100%|██████████| 20/20 [43:22<00:00, 127.72s/epoch]Training Progress: 100%|██████████| 20/20 [43:22<00:00, 130.15s/epoch]
31431.4s 793 Epoch 20/20 - loss: 0.0734 - val_loss: 0.0674 - val_acc: 81.97%
31431.4s 794 val_loss improved from 0.0689 to 0.0674, saving model...
31431.4s 795 Current LR: 0.000500
31431.4s 796 Loaded best model with val_loss: 0.0674
31431.4s 797 Best val_acc for this run: 81.97%
31431.4s 798 
31431.4s 799 Trying hyperparameters: lr=0.001, margin=1.5, threshold=0.3
31563.8s 800 Epoch 1/20 - loss: 2.4294 - val_loss: 0.2142 - val_acc: 63.50%
31563.8s 801 val_loss improved from inf to 0.2142, saving model...
31563.8s 802 Current LR: 0.001000
31696.2s 803 Epoch 2/20 - loss: 0.2032 - val_loss: 0.1761 - val_acc: 65.33%
31696.2s 804 val_loss improved from 0.2142 to 0.1761, saving model...
31696.2s 805 Current LR: 0.001000
31828.5s 806 Epoch 3/20 - loss: 0.1849 - val_loss: 0.1748 - val_acc: 67.81%
31828.5s 807 val_loss improved from 0.1761 to 0.1748, saving model...
31828.5s 808 Current LR: 0.001000
31960.6s 809 Epoch 4/20 - loss: 0.1826 - val_loss: 0.1893 - val_acc: 67.08%
31960.6s 810 Patience Counter: 1/10
31960.6s 811 Current LR: 0.001000
32092.7s 812 Epoch 5/20 - loss: 0.1782 - val_loss: 0.1831 - val_acc: 66.56%
32092.7s 813 Patience Counter: 2/10
32092.7s 814 Current LR: 0.001000
32224.9s 815 Epoch 6/20 - loss: 0.1746 - val_loss: 0.1675 - val_acc: 66.22%
32224.9s 816 val_loss improved from 0.1748 to 0.1675, saving model...
32224.9s 817 Current LR: 0.001000
32357.0s 818 Epoch 7/20 - loss: 0.1708 - val_loss: 0.1633 - val_acc: 66.73%
32357.0s 819 val_loss improved from 0.1675 to 0.1633, saving model...
32357.0s 820 Current LR: 0.001000
32488.6s 821 Epoch 8/20 - loss: 0.1693 - val_loss: 0.1589 - val_acc: 67.68%
32488.6s 822 val_loss improved from 0.1633 to 0.1589, saving model...
32488.6s 823 Current LR: 0.001000
32619.5s 824 Epoch 9/20 - loss: 0.1677 - val_loss: 0.1558 - val_acc: 66.27%
32619.5s 825 val_loss improved from 0.1589 to 0.1558, saving model...
32619.5s 826 Current LR: 0.001000
32750.2s 827 Epoch 10/20 - loss: 0.1672 - val_loss: 0.1584 - val_acc: 65.55%
32750.2s 828 Patience Counter: 1/10
32750.2s 829 Current LR: 0.001000
32880.3s 830 Epoch 11/20 - loss: 0.1668 - val_loss: 0.1514 - val_acc: 65.79%
32880.3s 831 val_loss improved from 0.1558 to 0.1514, saving model...
32880.3s 832 Current LR: 0.001000
33010.0s 833 Epoch 12/20 - loss: 0.1663 - val_loss: 0.1617 - val_acc: 65.43%
33010.0s 834 Patience Counter: 1/10
33010.0s 835 Current LR: 0.001000
33139.1s 836 Epoch 13/20 - loss: 0.1658 - val_loss: 0.1555 - val_acc: 67.26%
33139.1s 837 Patience Counter: 2/10
33139.1s 838 Current LR: 0.001000
33267.6s 839 Epoch 14/20 - loss: 0.1661 - val_loss: 0.1520 - val_acc: 66.19%
33267.6s 840 Patience Counter: 3/10
33267.6s 841 Current LR: 0.001000
33395.7s 842 Epoch 15/20 - loss: 0.1659 - val_loss: 0.1607 - val_acc: 66.72%
33395.7s 843 Patience Counter: 4/10
33395.7s 844 Current LR: 0.000500
33523.3s 845 Epoch 16/20 - loss: 0.1593 - val_loss: 0.1485 - val_acc: 66.24%
33523.3s 846 val_loss improved from 0.1514 to 0.1485, saving model...
33523.3s 847 Current LR: 0.000500
33650.3s 848 Epoch 17/20 - loss: 0.1585 - val_loss: 0.1438 - val_acc: 66.57%
33650.3s 849 val_loss improved from 0.1485 to 0.1438, saving model...
33650.3s 850 Current LR: 0.000500
33778.7s 851 Epoch 18/20 - loss: 0.1582 - val_loss: 0.1554 - val_acc: 66.00%
33778.7s 852 Patience Counter: 1/10
33778.7s 853 Current LR: 0.000500
33905.8s 854 Epoch 19/20 - loss: 0.1578 - val_loss: 0.1463 - val_acc: 68.78%
33905.8s 855 Patience Counter: 2/10
33905.8s 856 Current LR: 0.000500
34032.8s 857 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:53, 132.28s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:43, 132.40s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:29, 132.31s/epoch]Training Progress:  20%|██        | 4/20 [08:49<35:15, 132.22s/epoch]Training Progress:  25%|██▌       | 5/20 [11:01<33:02, 132.18s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:51, 132.22s/epoch]Training Progress:  35%|███▌      | 7/20 [15:25<28:38, 132.15s/epoch]Training Progress:  40%|████      | 8/20 [17:37<26:23, 132.00s/epoch]Training Progress:  45%|████▌     | 9/20 [19:48<24:08, 131.66s/epoch]Training Progress:  50%|█████     | 10/20 [21:58<21:53, 131.32s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:08<19:38, 130.98s/epoch]Training Progress:  60%|██████    | 12/20 [26:18<17:24, 130.57s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:27<15:10, 130.11s/epoch]Training Progress:  70%|███████   | 14/20 [30:36<12:57, 129.63s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:44<10:45, 129.15s/epoch]Training Progress:  80%|████████  | 16/20 [34:51<08:34, 128.67s/epoch]Training Progress:  85%|████████▌ | 17/20 [36:58<06:24, 128.22s/epoch]Training Progress:  90%|█████████ | 18/20 [39:07<04:16, 128.24s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:14<02:07, 127.91s/epoch]Training Progress: 100%|██████████| 20/20 [43:21<00:00, 127.64s/epoch]Training Progress: 100%|██████████| 20/20 [43:21<00:00, 130.06s/epoch]
34032.8s 858 Epoch 20/20 - loss: 0.1566 - val_loss: 0.1459 - val_acc: 67.30%
34032.8s 859 Patience Counter: 3/10
34032.8s 860 Current LR: 0.000500
34032.8s 861 Loaded best model with val_loss: 0.1438
34032.8s 862 Best val_acc for this run: 68.78%
34032.8s 863 
34032.8s 864 Trying hyperparameters: lr=0.001, margin=1.5, threshold=0.4
34165.0s 865 Epoch 1/20 - loss: 2.5602 - val_loss: 0.2236 - val_acc: 68.99%
34165.0s 866 val_loss improved from inf to 0.2236, saving model...
34165.0s 867 Current LR: 0.001000
34297.2s 868 Epoch 2/20 - loss: 0.2045 - val_loss: 0.1864 - val_acc: 69.84%
34297.2s 869 val_loss improved from 0.2236 to 0.1864, saving model...
34297.2s 870 Current LR: 0.001000
34429.3s 871 Epoch 3/20 - loss: 0.1900 - val_loss: 0.1735 - val_acc: 72.39%
34429.3s 872 val_loss improved from 0.1864 to 0.1735, saving model...
34429.3s 873 Current LR: 0.001000
34561.4s 874 Epoch 4/20 - loss: 0.1825 - val_loss: 0.1710 - val_acc: 70.97%
34561.4s 875 val_loss improved from 0.1735 to 0.1710, saving model...
34561.4s 876 Current LR: 0.001000
34693.2s 877 Epoch 5/20 - loss: 0.1795 - val_loss: 0.1632 - val_acc: 72.40%
34693.2s 878 val_loss improved from 0.1710 to 0.1632, saving model...
34693.2s 879 Current LR: 0.001000
34825.5s 880 Epoch 6/20 - loss: 0.1725 - val_loss: 0.1665 - val_acc: 70.32%
34825.5s 881 Patience Counter: 1/10
34825.5s 882 Current LR: 0.001000
34957.3s 883 Epoch 7/20 - loss: 0.1706 - val_loss: 0.1580 - val_acc: 74.08%
34957.3s 884 val_loss improved from 0.1632 to 0.1580, saving model...
34957.3s 885 Current LR: 0.001000
35088.7s 886 Epoch 8/20 - loss: 0.1686 - val_loss: 0.1541 - val_acc: 74.01%
35088.7s 887 val_loss improved from 0.1580 to 0.1541, saving model...
35088.7s 888 Current LR: 0.001000
35219.7s 889 Epoch 9/20 - loss: 0.1685 - val_loss: 0.1632 - val_acc: 73.51%
35219.7s 890 Patience Counter: 1/10
35219.7s 891 Current LR: 0.001000
35350.3s 892 Epoch 10/20 - loss: 0.1674 - val_loss: 0.1519 - val_acc: 73.78%
35350.3s 893 val_loss improved from 0.1541 to 0.1519, saving model...
35350.3s 894 Current LR: 0.001000
35480.5s 895 Epoch 11/20 - loss: 0.1671 - val_loss: 0.1496 - val_acc: 73.67%
35480.5s 896 val_loss improved from 0.1519 to 0.1496, saving model...
35480.5s 897 Current LR: 0.001000
35609.9s 898 Epoch 12/20 - loss: 0.1667 - val_loss: 0.1473 - val_acc: 72.92%
35609.9s 899 val_loss improved from 0.1496 to 0.1473, saving model...
35609.9s 900 Current LR: 0.001000
35739.0s 901 Epoch 13/20 - loss: 0.1660 - val_loss: 0.1551 - val_acc: 71.45%
35739.0s 902 Patience Counter: 1/10
35739.0s 903 Current LR: 0.001000
35867.4s 904 Epoch 14/20 - loss: 0.1653 - val_loss: 0.1602 - val_acc: 73.23%
35867.4s 905 Patience Counter: 2/10
35867.4s 906 Current LR: 0.001000
35995.7s 907 Epoch 15/20 - loss: 0.1663 - val_loss: 0.1715 - val_acc: 75.13%
35995.7s 908 Patience Counter: 3/10
35995.7s 909 Current LR: 0.001000
36123.4s 910 Epoch 16/20 - loss: 0.1656 - val_loss: 0.1702 - val_acc: 74.72%
36123.4s 911 Patience Counter: 4/10
36123.4s 912 Current LR: 0.000500
36251.4s 913 Epoch 17/20 - loss: 0.1594 - val_loss: 0.1506 - val_acc: 74.99%
36251.4s 914 Patience Counter: 5/10
36251.4s 915 Current LR: 0.000500
36378.5s 916 Epoch 18/20 - loss: 0.1592 - val_loss: 0.1455 - val_acc: 73.94%
36378.5s 917 val_loss improved from 0.1473 to 0.1455, saving model...
36378.5s 918 Current LR: 0.000500
36505.9s 919 Epoch 19/20 - loss: 0.1586 - val_loss: 0.1460 - val_acc: 73.93%
36505.9s 920 Patience Counter: 1/10
36505.9s 921 Current LR: 0.000500
36633.0s 922 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:50, 132.13s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:39, 132.18s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:26, 132.16s/epoch]Training Progress:  20%|██        | 4/20 [08:48<35:13, 132.10s/epoch]Training Progress:  25%|██▌       | 5/20 [11:00<33:00, 132.03s/epoch]Training Progress:  30%|███       | 6/20 [13:12<30:49, 132.08s/epoch]Training Progress:  35%|███▌      | 7/20 [15:24<28:36, 132.03s/epoch]Training Progress:  40%|████      | 8/20 [17:35<26:21, 131.82s/epoch]Training Progress:  45%|████▌     | 9/20 [19:46<24:07, 131.56s/epoch]Training Progress:  50%|█████     | 10/20 [21:57<21:52, 131.27s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:07<19:38, 130.94s/epoch]Training Progress:  60%|██████    | 12/20 [26:17<17:23, 130.47s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:26<15:10, 130.04s/epoch]Training Progress:  70%|███████   | 14/20 [30:34<12:57, 129.53s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:42<10:45, 129.11s/epoch]Training Progress:  80%|████████  | 16/20 [34:50<08:35, 128.77s/epoch]Training Progress:  85%|████████▌ | 17/20 [36:58<06:25, 128.48s/epoch]Training Progress:  90%|█████████ | 18/20 [39:05<04:16, 128.13s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:12<02:07, 127.87s/epoch]Training Progress: 100%|██████████| 20/20 [43:20<00:00, 127.67s/epoch]Training Progress: 100%|██████████| 20/20 [43:20<00:00, 130.01s/epoch]
36633.0s 923 Epoch 20/20 - loss: 0.1583 - val_loss: 0.1496 - val_acc: 76.33%
36633.0s 924 Patience Counter: 2/10
36633.0s 925 Current LR: 0.000500
36633.0s 926 Loaded best model with val_loss: 0.1455
36633.0s 927 Best val_acc for this run: 76.33%
36633.0s 928 
36633.0s 929 Trying hyperparameters: lr=0.001, margin=1.5, threshold=0.45
36765.3s 930 Epoch 1/20 - loss: 2.4184 - val_loss: 0.2160 - val_acc: 72.91%
36765.3s 931 val_loss improved from inf to 0.2160, saving model...
36765.3s 932 Current LR: 0.001000
36897.5s 933 Epoch 2/20 - loss: 0.2017 - val_loss: 0.1737 - val_acc: 72.89%
36897.5s 934 val_loss improved from 0.2160 to 0.1737, saving model...
36897.5s 935 Current LR: 0.001000
37030.0s 936 Epoch 3/20 - loss: 0.1895 - val_loss: 0.1692 - val_acc: 73.13%
37030.0s 937 val_loss improved from 0.1737 to 0.1692, saving model...
37030.0s 938 Current LR: 0.001000
37162.0s 939 Epoch 4/20 - loss: 0.1827 - val_loss: 0.1682 - val_acc: 75.21%
37162.0s 940 val_loss improved from 0.1692 to 0.1682, saving model...
37162.0s 941 Current LR: 0.001000
37294.1s 942 Epoch 5/20 - loss: 0.1768 - val_loss: 0.1501 - val_acc: 76.54%
37294.1s 943 val_loss improved from 0.1682 to 0.1501, saving model...
37294.1s 944 Current LR: 0.001000
37426.6s 945 Epoch 6/20 - loss: 0.1719 - val_loss: 0.1562 - val_acc: 76.94%
37426.6s 946 Patience Counter: 1/10
37426.6s 947 Current LR: 0.001000
37558.7s 948 Epoch 7/20 - loss: 0.1703 - val_loss: 0.1553 - val_acc: 76.51%
37558.7s 949 Patience Counter: 2/10
37558.7s 950 Current LR: 0.001000
37690.3s 951 Epoch 8/20 - loss: 0.1688 - val_loss: 0.1618 - val_acc: 75.85%
37690.3s 952 Patience Counter: 3/10
37690.3s 953 Current LR: 0.001000
37821.2s 954 Epoch 9/20 - loss: 0.1678 - val_loss: 0.1562 - val_acc: 74.59%
37821.2s 955 Patience Counter: 4/10
37821.2s 956 Current LR: 0.000500
37952.2s 957 Epoch 10/20 - loss: 0.1596 - val_loss: 0.1480 - val_acc: 74.72%
37952.2s 958 val_loss improved from 0.1501 to 0.1480, saving model...
37952.2s 959 Current LR: 0.000500
38083.0s 960 Epoch 11/20 - loss: 0.1588 - val_loss: 0.1522 - val_acc: 77.12%
38083.0s 961 Patience Counter: 1/10
38083.0s 962 Current LR: 0.000500
38213.2s 963 Epoch 12/20 - loss: 0.1582 - val_loss: 0.1506 - val_acc: 77.31%
38213.2s 964 Patience Counter: 2/10
38213.2s 965 Current LR: 0.000500
38343.6s 966 Epoch 13/20 - loss: 0.1572 - val_loss: 0.1432 - val_acc: 74.85%
38343.6s 967 val_loss improved from 0.1480 to 0.1432, saving model...
38343.6s 968 Current LR: 0.000500
38473.0s 969 Epoch 14/20 - loss: 0.1572 - val_loss: 0.1464 - val_acc: 78.41%
38473.0s 970 Patience Counter: 1/10
38473.0s 971 Current LR: 0.000500
38601.8s 972 Epoch 15/20 - loss: 0.1560 - val_loss: 0.1531 - val_acc: 76.14%
38601.8s 973 Patience Counter: 2/10
38601.8s 974 Current LR: 0.000500
38730.1s 975 Epoch 16/20 - loss: 0.1560 - val_loss: 0.1416 - val_acc: 77.12%
38730.1s 976 val_loss improved from 0.1432 to 0.1416, saving model...
38730.1s 977 Current LR: 0.000500
38858.4s 978 Epoch 17/20 - loss: 0.1556 - val_loss: 0.1450 - val_acc: 77.56%
38858.4s 979 Patience Counter: 1/10
38858.4s 980 Current LR: 0.000500
38986.1s 981 Epoch 18/20 - loss: 0.1552 - val_loss: 0.1496 - val_acc: 76.74%
38986.1s 982 Patience Counter: 2/10
38986.1s 983 Current LR: 0.000500
39114.0s 984 Epoch 19/20 - loss: 0.1550 - val_loss: 0.1481 - val_acc: 78.37%
39114.0s 985 Patience Counter: 3/10
39114.0s 986 Current LR: 0.000500
39242.0s 987 Epoch 20/20 - loss: 0.1548 - val_loss: 0.1416 - val_acc: 77.23%
39242.0s 988 Patience Counter: 4/10
39242.0s 989 Current LR: 0.000250
39242.0s 990 Loaded best model with val_loss: 0.1416
39242.0s 991 Best val_acc for this run: 78.41%
39242.0s 992 
39242.0s 993 Trying hyperparameters: lr=0.001, margin=1.5, threshold=0.5
39242.0s 994 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:51, 132.20s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:40, 132.22s/epoch]Training Progress:  15%|█▌        | 3/20 [06:36<37:29, 132.34s/epoch]Training Progress:  20%|██        | 4/20 [08:48<35:15, 132.22s/epoch]Training Progress:  25%|██▌       | 5/20 [11:01<33:02, 132.19s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:51, 132.26s/epoch]Training Progress:  35%|███▌      | 7/20 [15:25<28:38, 132.22s/epoch]Training Progress:  40%|████      | 8/20 [17:37<26:24, 132.00s/epoch]Training Progress:  45%|████▌     | 9/20 [19:48<24:08, 131.67s/epoch]Training Progress:  50%|█████     | 10/20 [21:59<21:54, 131.45s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:09<19:41, 131.24s/epoch]Training Progress:  60%|██████    | 12/20 [26:19<17:27, 130.92s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:30<15:15, 130.81s/epoch]Training Progress:  70%|███████   | 14/20 [30:39<13:01, 130.32s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:48<10:49, 129.89s/epoch]Training Progress:  80%|████████  | 16/20 [34:57<08:37, 129.45s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:05<06:27, 129.04s/epoch]Training Progress:  90%|█████████ | 18/20 [39:13<04:17, 128.68s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:20<02:08, 128.42s/epoch]Training Progress: 100%|██████████| 20/20 [43:28<00:00, 128.26s/epoch]Training Progress: 100%|██████████| 20/20 [43:28<00:00, 130.44s/epoch]
39374.3s 995 Epoch 1/20 - loss: 2.7173 - val_loss: 0.2559 - val_acc: 73.42%
39374.3s 996 val_loss improved from inf to 0.2559, saving model...
39374.3s 997 Current LR: 0.001000
39506.6s 998 Epoch 2/20 - loss: 0.2046 - val_loss: 0.2069 - val_acc: 76.60%
39506.6s 999 val_loss improved from 0.2559 to 0.2069, saving model...
39506.6s 1000 Current LR: 0.001000
39639.1s 1001 Epoch 3/20 - loss: 0.1871 - val_loss: 0.1677 - val_acc: 76.54%
39639.1s 1002 val_loss improved from 0.2069 to 0.1677, saving model...
39639.1s 1003 Current LR: 0.001000
39771.2s 1004 Epoch 4/20 - loss: 0.1791 - val_loss: 0.1574 - val_acc: 75.66%
39771.2s 1005 val_loss improved from 0.1677 to 0.1574, saving model...
39771.2s 1006 Current LR: 0.001000
39903.6s 1007 Epoch 5/20 - loss: 0.1723 - val_loss: 0.1625 - val_acc: 77.94%
39903.6s 1008 Patience Counter: 1/10
39903.6s 1009 Current LR: 0.001000
40035.7s 1010 Epoch 6/20 - loss: 0.1713 - val_loss: 0.1586 - val_acc: 78.53%
40035.7s 1011 Patience Counter: 2/10
40035.7s 1012 Current LR: 0.001000
40167.7s 1013 Epoch 7/20 - loss: 0.1707 - val_loss: 0.1616 - val_acc: 76.99%
40167.7s 1014 Patience Counter: 3/10
40167.7s 1015 Current LR: 0.001000
40299.4s 1016 Epoch 8/20 - loss: 0.1693 - val_loss: 0.1637 - val_acc: 78.34%
40299.4s 1017 Patience Counter: 4/10
40299.4s 1018 Current LR: 0.000500
40430.7s 1019 Epoch 9/20 - loss: 0.1614 - val_loss: 0.1563 - val_acc: 79.37%
40430.7s 1020 val_loss improved from 0.1574 to 0.1563, saving model...
40430.7s 1021 Current LR: 0.000500
40561.9s 1022 Epoch 10/20 - loss: 0.1595 - val_loss: 0.1500 - val_acc: 76.88%
40561.9s 1023 val_loss improved from 0.1563 to 0.1500, saving model...
40561.9s 1024 Current LR: 0.000500
40693.4s 1025 Epoch 11/20 - loss: 0.1581 - val_loss: 0.1466 - val_acc: 80.03%
40693.4s 1026 val_loss improved from 0.1500 to 0.1466, saving model...
40693.4s 1027 Current LR: 0.000500
40824.0s 1028 Epoch 12/20 - loss: 0.1573 - val_loss: 0.1512 - val_acc: 78.58%
40824.0s 1029 Patience Counter: 1/10
40824.0s 1030 Current LR: 0.000500
40953.9s 1031 Epoch 13/20 - loss: 0.1564 - val_loss: 0.1438 - val_acc: 78.54%
40953.9s 1032 val_loss improved from 0.1466 to 0.1438, saving model...
40953.9s 1033 Current LR: 0.000500
41083.6s 1034 Epoch 14/20 - loss: 0.1549 - val_loss: 0.1424 - val_acc: 80.36%
41083.6s 1035 val_loss improved from 0.1438 to 0.1424, saving model...
41083.6s 1036 Current LR: 0.000500
41212.4s 1037 Epoch 15/20 - loss: 0.1550 - val_loss: 0.1411 - val_acc: 79.22%
41212.4s 1038 val_loss improved from 0.1424 to 0.1411, saving model...
41212.4s 1039 Current LR: 0.000500
41340.6s 1040 Epoch 16/20 - loss: 0.1543 - val_loss: 0.1402 - val_acc: 79.41%
41340.6s 1041 val_loss improved from 0.1411 to 0.1402, saving model...
41340.6s 1042 Current LR: 0.000500
41468.8s 1043 Epoch 17/20 - loss: 0.1535 - val_loss: 0.1425 - val_acc: 78.82%
41468.8s 1044 Patience Counter: 1/10
41468.8s 1045 Current LR: 0.000500
41596.6s 1046 Epoch 18/20 - loss: 0.1529 - val_loss: 0.1441 - val_acc: 80.74%
41596.6s 1047 Patience Counter: 2/10
41596.6s 1048 Current LR: 0.000500
41724.5s 1049 Epoch 19/20 - loss: 0.1530 - val_loss: 0.1387 - val_acc: 79.33%
41724.5s 1050 val_loss improved from 0.1402 to 0.1387, saving model...
41724.5s 1051 Current LR: 0.000500
41852.3s 1052 Epoch 20/20 - loss: 0.1525 - val_loss: 0.1403 - val_acc: 79.63%
41852.3s 1053 Patience Counter: 1/10
41852.3s 1054 Current LR: 0.000500
41852.3s 1055 Loaded best model with val_loss: 0.1387
41852.3s 1056 Best val_acc for this run: 80.74%
41852.3s 1057 
41852.3s 1058 Best hyperparameters: {'lr': 0.0005, 'margin': 1.0, 'threshold': 0.45}, Best val_acc: 84.34%
41852.3s 1059 Training Progress:   0%|          | 0/20 [00:00<?, ?epoch/s]Training Progress:   5%|▌         | 1/20 [02:12<41:57, 132.49s/epoch]Training Progress:  10%|█         | 2/20 [04:24<39:42, 132.39s/epoch]Training Progress:  15%|█▌        | 3/20 [06:37<37:30, 132.41s/epoch]Training Progress:  20%|██        | 4/20 [08:49<35:16, 132.30s/epoch]Training Progress:  25%|██▌       | 5/20 [11:01<33:03, 132.26s/epoch]Training Progress:  30%|███       | 6/20 [13:13<30:50, 132.21s/epoch]Training Progress:  35%|███▌      | 7/20 [15:25<28:37, 132.15s/epoch]Training Progress:  40%|████      | 8/20 [17:37<26:24, 132.02s/epoch]Training Progress:  45%|████▌     | 9/20 [19:48<24:09, 131.82s/epoch]Training Progress:  50%|█████     | 10/20 [22:00<21:56, 131.63s/epoch]Training Progress:  55%|█████▌    | 11/20 [24:11<19:44, 131.59s/epoch]Training Progress:  60%|██████    | 12/20 [26:21<17:30, 131.25s/epoch]Training Progress:  65%|██████▌   | 13/20 [28:32<15:16, 130.88s/epoch]Training Progress:  70%|███████   | 14/20 [30:41<13:02, 130.48s/epoch]Training Progress:  75%|███████▌  | 15/20 [32:50<10:49, 129.98s/epoch]Training Progress:  80%|████████  | 16/20 [34:58<08:37, 129.48s/epoch]Training Progress:  85%|████████▌ | 17/20 [37:06<06:27, 129.07s/epoch]Training Progress:  90%|█████████ | 18/20 [39:14<04:17, 128.69s/epoch]Training Progress:  95%|█████████▌| 19/20 [41:22<02:08, 128.48s/epoch]Training Progress: 100%|██████████| 20/20 [43:30<00:00, 128.27s/epoch]Training Progress: 100%|██████████| 20/20 [43:30<00:00, 130.52s/epoch]
42006.0s 1060 Epoch 1/30 - loss: 0.0700 - val_loss: 0.0652 - val_acc: 83.22%
42006.0s 1061 val_loss improved from inf to 0.0652, saving model...
42006.0s 1062 Current LR: 0.000500
42158.9s 1063 Epoch 2/30 - loss: 0.0696 - val_loss: 0.0665 - val_acc: 82.19%
42158.9s 1064 Patience Counter: 1/10
42158.9s 1065 Current LR: 0.000500
42311.6s 1066 Epoch 3/30 - loss: 0.0694 - val_loss: 0.0610 - val_acc: 83.96%
42311.6s 1067 val_loss improved from 0.0652 to 0.0610, saving model...
42311.6s 1068 Current LR: 0.000500
42464.9s 1069 Epoch 4/30 - loss: 0.0694 - val_loss: 0.0616 - val_acc: 83.94%
42464.9s 1070 Patience Counter: 1/10
42464.9s 1071 Current LR: 0.000500
42618.3s 1072 Epoch 5/30 - loss: 0.0696 - val_loss: 0.0629 - val_acc: 83.46%
42618.3s 1073 Patience Counter: 2/10
42618.3s 1074 Current LR: 0.000500
42771.7s 1075 Epoch 6/30 - loss: 0.0695 - val_loss: 0.0659 - val_acc: 82.46%
42771.7s 1076 Patience Counter: 3/10
42771.7s 1077 Current LR: 0.000500
42924.9s 1078 Epoch 7/30 - loss: 0.0694 - val_loss: 0.0607 - val_acc: 84.38%
42924.9s 1079 val_loss improved from 0.0610 to 0.0607, saving model...
42924.9s 1080 Current LR: 0.000500
43078.6s 1081 Epoch 8/30 - loss: 0.0697 - val_loss: 0.0609 - val_acc: 84.47%
43078.6s 1082 Patience Counter: 1/10
43078.6s 1083 Current LR: 0.000500
43211.2s 1084 Training Progress:   0%|          | 0/30 [00:00<?, ?epoch/s]Training Progress:   3%|▎         | 1/30 [02:32<1:13:52, 152.85s/epoch]Training Progress:   7%|▋         | 2/30 [05:05<1:11:17, 152.76s/epoch]Training Progress:  10%|█         | 3/30 [07:38<1:08:45, 152.80s/epoch]Training Progress:  13%|█▎        | 4/30 [10:11<1:06:17, 152.97s/epoch]Training Progress:  17%|█▋        | 5/30 [12:45<1:03:48, 153.14s/epoch]Training Progress:  20%|██        | 6/30 [15:18<1:01:17, 153.23s/epoch]Training Progress:  23%|██▎       | 7/30 [17:51<58:44, 153.24s/epoch]  Training Progress:  27%|██▋       | 8/30 [20:25<56:13, 153.34s/epoch]